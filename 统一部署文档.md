# ç»Ÿä¸€éƒ¨ç½²æ–‡æ¡£

> å¿«é€Ÿéƒ¨ç½²å‚è€ƒæŒ‡å—

## ğŸ“‹ éƒ¨ç½²æµç¨‹æ¦‚è§ˆ

1. **ç¯å¢ƒå‡†å¤‡** - å®‰è£…Pythonã€PostgreSQLã€Redisã€Nginx
2. **æ•°æ®åº“é…ç½®** - åˆ›å»ºæ•°æ®åº“ã€é…ç½®è¿æ¥
3. **ä»£ç éƒ¨ç½²** - å…‹éš†ä»£ç ã€å®‰è£…ä¾èµ–
4. **æœåŠ¡å¯åŠ¨** - å¯åŠ¨Gunicornã€Nginx
5. **éªŒè¯æµ‹è¯•** - æ£€æŸ¥æœåŠ¡çŠ¶æ€ã€æµ‹è¯•æ¥å£

---

## ğŸš€ å¿«é€Ÿéƒ¨ç½²æ­¥éª¤

### 1. ç¯å¢ƒå‡†å¤‡

```bash
# æ›´æ–°ç³»ç»Ÿ
sudo apt update && sudo apt upgrade -y

# å®‰è£…Python 3.8+
sudo apt install python3 python3-pip python3-venv -y

# å®‰è£…PostgreSQL
sudo apt install postgresql postgresql-contrib -y

# å®‰è£…Redis
sudo apt install redis-server -y

# å®‰è£…Nginx
sudo apt install nginx -y
```

### 2. æ•°æ®åº“é…ç½®

```bash
# åˆ›å»ºæ•°æ®åº“å’Œç”¨æˆ·
sudo -u postgres psql
CREATE DATABASE pet_painting;
CREATE USER aistudio_user WITH PASSWORD 'your_password';
GRANT ALL PRIVILEGES ON DATABASE pet_painting TO aistudio_user;
\q
```

### 3. ä»£ç éƒ¨ç½²

```bash
# å…‹éš†ä»£ç 
git clone <repository_url>
cd aistudio

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python3 -m venv venv
source venv/bin/activate

# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# é…ç½®ç¯å¢ƒå˜é‡
cp .env.example .env
# ç¼–è¾‘.envæ–‡ä»¶ï¼Œè®¾ç½®æ•°æ®åº“è¿æ¥ç­‰ä¿¡æ¯
```

### 4. æ•°æ®åº“åˆå§‹åŒ–

```bash
# åˆå§‹åŒ–æ•°æ®åº“è¡¨ç»“æ„
python scripts/database/setup_postgresql.py

# è¿ç§»æ•°æ®ï¼ˆå¦‚æœæœ‰æ—§æ•°æ®ï¼‰
python migrate_data_auto.py
```

### 5. æœåŠ¡å¯åŠ¨

```bash
# å¯åŠ¨Redis
sudo systemctl start redis
sudo systemctl enable redis

# å¯åŠ¨Gunicornï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
gunicorn -c gunicorn.conf.py test_server:app

# æˆ–ä½¿ç”¨å¯åŠ¨è„šæœ¬
python start_production.py
```

### 6. é…ç½®Nginx

```bash
# å¤åˆ¶Nginxé…ç½®
sudo cp config/nginx_linux.conf /etc/nginx/sites-available/aistudio
sudo ln -s /etc/nginx/sites-available/aistudio /etc/nginx/sites-enabled/

# æµ‹è¯•é…ç½®
sudo nginx -t

# é‡å¯Nginx
sudo systemctl restart nginx
```

### 7. éªŒè¯æµ‹è¯•

```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
curl http://localhost:8000/health
curl http://localhost/api/health

# æ£€æŸ¥Nginx
curl http://your-domain.com
```

---

## ğŸ“š è¯¦ç»†æ–‡æ¡£

### éƒ¨ç½²ç›¸å…³
- **ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æŒ‡å—**: `docs/deployment/ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æŒ‡å—.md`
- **å¿«é€Ÿéƒ¨ç½²åˆ°é˜¿é‡Œäº‘**: `docs/deployment/å¿«é€Ÿéƒ¨ç½²åˆ°é˜¿é‡Œäº‘.md`
- **é˜¿é‡Œäº‘æœåŠ¡å™¨éƒ¨ç½²å®Œæ•´æŒ‡å—**: `docs/deployment/é˜¿é‡Œäº‘æœåŠ¡å™¨éƒ¨ç½²å®Œæ•´æŒ‡å—.md`

### æ•°æ®åº“ç›¸å…³
- **PostgreSQLè¿ç§»æŒ‡å—**: `docs/deployment/PostgreSQLè¿ç§»æŒ‡å—.md`
- **PostgreSQLå¿«é€Ÿè®¾ç½®æ­¥éª¤**: `docs/deployment/PostgreSQLå¿«é€Ÿè®¾ç½®æ­¥éª¤.md`
- **æ•°æ®åº“å¤‡ä»½æ–¹æ¡ˆ**: `é˜¿é‡Œäº‘æœåŠ¡å™¨å¤‡ä»½è„šæœ¬-æ•°æ®åº“è‡ªåŠ¨å¤‡ä»½é…ç½®æ–¹æ¡ˆ.md`

### Redisç›¸å…³
- **Rediså®‰è£…å’Œé…ç½®æŒ‡å—**: `docs/deployment/Rediså®‰è£…å’Œé…ç½®æŒ‡å—.md`
- **äº‘ç«¯æœåŠ¡å™¨-linux-SQLæ•°æ®åº“æ›´æ¢éƒ¨ç½²ä¸å®‰è£…Rediså®‰è£….md**

### å…¶ä»–é…ç½®
- **FRPé…ç½®**: `æ‰“å°æœºé…ç½®æ–‡æ¡£-å¤šé—¨åº—FRPé…ç½®æ–¹æ¡ˆ.md`
- **åŸŸåè¯ä¹¦éƒ¨ç½²**: `é˜¿é‡Œäº‘æœåŠ¡å™¨-åŸŸåè¯ä¹¦éƒ¨ç½².md`
- **OSSå­˜å‚¨æ¡¶é…ç½®**: `é˜¿é‡Œäº‘-é…ç½®OSSå­˜å‚¨æ¡¶è¯´æ˜.md`

---

## âš™ï¸ éœ€è¦å®‰è£…çš„ä¾èµ–

### ç³»ç»Ÿä¾èµ–
- Python 3.8+
- PostgreSQL 12+
- Redis 6+
- Nginx 1.18+

### Pythonä¾èµ–
è§ `requirements.txt` æ–‡ä»¶

### éœ€è¦è¿è¡Œçš„è„šæœ¬
1. `scripts/database/setup_postgresql.py` - æ•°æ®åº“åˆå§‹åŒ–
2. `migrate_data_auto.py` - æ•°æ®è¿ç§»ï¼ˆå¯é€‰ï¼‰
3. `start_production.py` - å¯åŠ¨ç”Ÿäº§æœåŠ¡

---

## ğŸ”§ å¸¸ç”¨å‘½ä»¤

### æœåŠ¡ç®¡ç†
```bash
# å¯åŠ¨Gunicorn
gunicorn -c gunicorn.conf.py test_server:app

# é‡å¯Nginx
sudo systemctl restart nginx

# æŸ¥çœ‹æ—¥å¿—
tail -f logs/app.log
tail -f logs/error.log
```

### æ•°æ®åº“ç®¡ç†
```bash
# å¤‡ä»½æ•°æ®åº“
pg_dump -U aistudio_user pet_painting > backup.sql

# æ¢å¤æ•°æ®åº“
psql -U aistudio_user pet_painting < backup.sql
```

---

**æœ€åæ›´æ–°**: 2026-02-05  
**æ–‡æ¡£ç‰ˆæœ¬**: v2.0
