# test_server.py å‰©ä½™ä»£ç åˆ†æ

## ğŸ“Š å½“å‰çŠ¶æ€

- **æ€»è¡Œæ•°**: 10,646 è¡Œ
- **å‰©ä½™è·¯ç”±**: 40 ä¸ª `@app.route` è£…é¥°å™¨
- **å‡½æ•°/ç±»**: 59 ä¸ª
- **æ³¨é‡Šæ ‡è®°**: 138 ä¸ªï¼ˆåŒ…æ‹¬å·²è¿ç§»æ ‡è®°ï¼‰

## ğŸ” å‰©ä½™ä»£ç åˆ†ç±»

### 1. å¿…é¡»ä¿ç•™çš„ä»£ç ï¼ˆçº¦ 1,500 è¡Œï¼‰

#### Flaskåº”ç”¨åˆå§‹åŒ–ï¼ˆçº¦ 200 è¡Œï¼‰
- Flaskåº”ç”¨åˆ›å»º
- æ•°æ®åº“åˆå§‹åŒ–
- ç™»å½•ç®¡ç†å™¨åˆå§‹åŒ–
- ä¸­é—´ä»¶é…ç½®
- è“å›¾æ³¨å†Œ

#### æ•°æ®åº“æ¨¡å‹å¯¼å…¥ï¼ˆçº¦ 50 è¡Œï¼‰
- ä» `app.models` å¯¼å…¥æ‰€æœ‰æ¨¡å‹
- æ¨¡å‹å…³ç³»å®šä¹‰

#### åˆå§‹åŒ–å‡½æ•°ï¼ˆçº¦ 500 è¡Œï¼‰
- `migrate_database()` - æ•°æ®åº“è¿ç§»
- `init_default_data()` - åˆå§‹åŒ–é»˜è®¤æ•°æ®
- `init_concurrency_configs()` - åˆå§‹åŒ–å¹¶å‘é…ç½®

#### æ¨¡æ¿è¿‡æ»¤å™¨ï¼ˆçº¦ 50 è¡Œï¼‰
- `@app.template_filter` è£…é¥°çš„å‡½æ•°
- å¯ä»¥åœ¨ `app/utils/template_filters.py` ä¸­æ‹†åˆ†

#### è¾…åŠ©å‡½æ•°ï¼ˆçº¦ 700 è¡Œï¼‰
- `get_order_images()` - è·å–è®¢å•å›¾ç‰‡
- `get_referrer_user_id()` - è·å–æ¨èäººID
- `send_subscribe_message()` - å‘é€è®¢é˜…æ¶ˆæ¯
- `calculate_visit_frequency()` - è®¡ç®—è®¿é—®é¢‘ç‡
- å…¶ä»–å·¥å…·å‡½æ•°

### 2. å¯ä»¥æ‹†åˆ†çš„è·¯ç”±ï¼ˆçº¦ 3,000 è¡Œï¼‰

#### ğŸ”´ é«˜ä¼˜å…ˆçº§ - åº”è¯¥æ‹†åˆ†

**1. æ”¯ä»˜ç›¸å…³è·¯ç”±ï¼ˆ2ä¸ªè·¯ç”±ï¼Œçº¦ 300 è¡Œï¼‰**
- `/api/payment/create` - åˆ›å»ºæ”¯ä»˜
- `/api/payment/notify` - æ”¯ä»˜å›è°ƒ
- **å»ºè®®**: æ£€æŸ¥ `app/routes/payment.py` æ˜¯å¦å·²æœ‰ï¼Œå¦‚æœæ²¡æœ‰åˆ™è¿ç§»

**2. ä¼˜æƒ åˆ¸ç›¸å…³è·¯ç”±ï¼ˆ10ä¸ªè·¯ç”±ï¼Œçº¦ 800 è¡Œï¼‰**
- `/api/coupons/list` - è·å–ä¼˜æƒ åˆ¸åˆ—è¡¨
- `/api/coupons/user/<user_id>` - è·å–ç”¨æˆ·ä¼˜æƒ åˆ¸
- `/api/coupons/available` - è·å–å¯ç”¨ä¼˜æƒ åˆ¸
- `/api/coupons/get` - è·å–ä¼˜æƒ åˆ¸
- `/api/coupons/validate` - éªŒè¯ä¼˜æƒ åˆ¸
- `/api/coupons/use` - ä½¿ç”¨ä¼˜æƒ åˆ¸
- `/api/admin/coupons/create` - åˆ›å»ºä¼˜æƒ åˆ¸ï¼ˆç®¡ç†åå°ï¼‰
- `/api/admin/coupons/<id>/update` - æ›´æ–°ä¼˜æƒ åˆ¸
- `/api/admin/coupons/<id>/delete` - åˆ é™¤ä¼˜æƒ åˆ¸
- `/admin/coupons` - ä¼˜æƒ åˆ¸ç®¡ç†é¡µé¢
- **å»ºè®®**: è¿ç§»åˆ° `app/routes/coupon_api.py`ï¼ˆéƒ¨åˆ†å·²å­˜åœ¨ï¼‰

**3. é¦–é¡µç®¡ç†APIï¼ˆ7ä¸ªè·¯ç”±ï¼Œçº¦ 500 è¡Œï¼‰**
- `/api/admin/homepage/banners` (GET/POST/PUT/DELETE)
- `/api/admin/homepage/config` (GET/PUT)
- `/api/admin/homepage/features` (PUT)
- **å»ºè®®**: è¿ç§»åˆ° `app/routes/admin_homepage_api.py`ï¼ˆéƒ¨åˆ†å·²å­˜åœ¨ï¼‰

**4. ç”¨æˆ·ç®¡ç†è·¯ç”±ï¼ˆ3ä¸ªè·¯ç”±ï¼Œçº¦ 400 è¡Œï¼‰**
- `/admin/users` - ç”¨æˆ·ç®¡ç†é¡µé¢
- `/api/admin/users/all` - è·å–æ‰€æœ‰ç”¨æˆ·
- `/api/admin/promotion/user/own-orders` - è·å–ç”¨æˆ·è‡ªå·±çš„è®¢å•
- **å»ºè®®**: è¿ç§»åˆ° `app/routes/admin_users_api.py`

**5. æ¶ˆæ¯é€šçŸ¥APIï¼ˆ3ä¸ªè·¯ç”±ï¼Œçº¦ 500 è¡Œï¼‰**
- `/api/admin/send-order-completion-notification` - å‘é€è®¢å•å®Œæˆé€šçŸ¥
- `/api/admin/send-commission-notification` - å‘é€ä½£é‡‘é€šçŸ¥
- `/api/admin/send-message` - å‘é€æ¶ˆæ¯
- `/api/admin/batch-send-message` - æ‰¹é‡å‘é€æ¶ˆæ¯
- **å»ºè®®**: è¿ç§»åˆ° `app/routes/admin_notification_api.py`

#### ğŸŸ¡ ä¸­ä¼˜å…ˆçº§ - å»ºè®®æ‹†åˆ†

**6. ç‰©æµå›è°ƒAPIï¼ˆ3ä¸ªè·¯ç”±ï¼Œçº¦ 200 è¡Œï¼‰**
- `/api/printer/logistics-callback` - æ‰“å°æœºç‰©æµå›è°ƒ
- `/api/logistics/callback` - ç‰©æµå›è°ƒ
- `/api/logistics/test` - ç‰©æµæµ‹è¯•
- **å»ºè®®**: è¿ç§»åˆ° `app/routes/logistics_api.py`

**7. ç®¡ç†åå°å·¥å…·APIï¼ˆ5ä¸ªè·¯ç”±ï¼Œçº¦ 300 è¡Œï¼‰**
- `/api/admin/init-data` - åˆå§‹åŒ–æ•°æ®
- `/api/admin/clean-duplicates` - æ¸…ç†é‡å¤æ•°æ®
- `/api/admin/update-cover-images` - æ›´æ–°å°é¢å›¾ç‰‡
- `/api/admin/upload-image` - ä¸Šä¼ å›¾ç‰‡
- `/admin/clear-test-data` - æ¸…ç†æµ‹è¯•æ•°æ®
- **å»ºè®®**: è¿ç§»åˆ° `app/routes/admin_tools_api.py`

**8. äº§å“å°ºå¯¸ç®¡ç†ï¼ˆ1ä¸ªè·¯ç”±ï¼Œçº¦ 200 è¡Œï¼‰**
- `/admin/sizes` - å°ºå¯¸ç®¡ç†é¡µé¢
- **å»ºè®®**: è¿ç§»åˆ° `app/routes/admin.py` æˆ–åˆ›å»º `app/routes/admin_products_api.py`

**9. äºŒç»´ç ç”Ÿæˆï¼ˆ1ä¸ªè·¯ç”±ï¼Œçº¦ 100 è¡Œï¼‰**
- `/api/qrcode/generate` - ç”ŸæˆäºŒç»´ç 
- **å»ºè®®**: è¿ç§»åˆ° `app/routes/qrcode_api.py` æˆ– `app/utils/qrcode_utils.py`

#### ğŸŸ¢ ä½ä¼˜å…ˆçº§ - å¯é€‰æ‹†åˆ†

**10. è°ƒè¯•å’Œæµ‹è¯•è·¯ç”±ï¼ˆ4ä¸ªè·¯ç”±ï¼Œçº¦ 200 è¡Œï¼‰**
- `/api/debug/payment` - æ”¯ä»˜è°ƒè¯•
- `/api/coupons/test` - ä¼˜æƒ åˆ¸æµ‹è¯•
- `/api/coupons/debug` - ä¼˜æƒ åˆ¸è°ƒè¯•
- `/api/example-images` - è·å–ç¤ºä¾‹å›¾ç‰‡
- **å»ºè®®**: å¯ä»¥ä¿ç•™åœ¨ `test_server.py` æˆ–è¿ç§»åˆ° `app/routes/debug_api.py`

**11. æŠ–éŸ³å¼€æ”¾å¹³å°åŠŸèƒ½ï¼ˆ5ä¸ªè·¯ç”±ï¼Œçº¦ 200 è¡Œï¼‰**
- `/admin/douyin` - æŠ–éŸ³åŒæ­¥ç®¡ç†é¡µé¢
- `/test/douyin` - æµ‹è¯•æŠ–éŸ³é¡µé¢
- `/api/douyin/sync/recent` - åŒæ­¥æœ€è¿‘è®¢å•
- `/api/douyin/sync/all` - åŒæ­¥æ‰€æœ‰è®¢å•
- `/api/douyin/webhook/status` - è·å–åŒæ­¥çŠ¶æ€
- **è¯´æ˜**: è¿™äº›è·¯ç”±é€šè¿‡æ¡ä»¶å¯¼å…¥æ³¨å†Œï¼Œå¯ä»¥ä¿ç•™æˆ–æ‹†åˆ†åˆ° `app/routes/douyin_api.py`

### 3. å·²æ³¨é‡Šçš„æ—§ä»£ç ï¼ˆçº¦ 1,000 è¡Œï¼‰

- å·²è¿ç§»è·¯ç”±çš„å‡½æ•°ä½“ï¼ˆå·²æ³¨é‡Šä½†æœªåˆ é™¤ï¼‰
- å¯ä»¥åˆ é™¤ä»¥å‡å°æ–‡ä»¶å¤§å°

### 4. æ³¨é‡Šå’Œç©ºè¡Œï¼ˆçº¦ 2,000 è¡Œï¼‰

- ä»£ç æ³¨é‡Š
- ç©ºè¡Œ
- åˆ†éš”çº¿

## ğŸ“ˆ æ‹†åˆ†è¿›åº¦

### å·²å®Œæˆæ‹†åˆ†
- âœ… ç®¡ç†åå°æ¨å¹¿ç®¡ç†APIï¼ˆ12ä¸ªè·¯ç”±ï¼‰
- âœ… é¢„çº¦æ‹ç…§APIï¼ˆ5ä¸ªè·¯ç”±ï¼‰- å·²åˆ é™¤
- âœ… å°ç¨‹åºè·¯ç”±ï¼ˆ14ä¸ªè·¯ç”±ï¼‰
- âœ… ç®¡ç†åå°è®¢å•ç›¸å…³è·¯ç”±ï¼ˆ4ä¸ªè·¯ç”±ï¼‰
- âœ… ç®¡ç†åå°é£æ ¼ç®¡ç†APIï¼ˆ12ä¸ªè·¯ç”±ï¼‰

### å¾…æ‹†åˆ†
- â³ æ”¯ä»˜ç›¸å…³è·¯ç”±ï¼ˆ2ä¸ªè·¯ç”±ï¼‰
- â³ ä¼˜æƒ åˆ¸ç›¸å…³è·¯ç”±ï¼ˆ10ä¸ªè·¯ç”±ï¼‰
- â³ é¦–é¡µç®¡ç†APIï¼ˆ7ä¸ªè·¯ç”±ï¼‰
- â³ ç”¨æˆ·ç®¡ç†è·¯ç”±ï¼ˆ3ä¸ªè·¯ç”±ï¼‰
- â³ æ¶ˆæ¯é€šçŸ¥APIï¼ˆ4ä¸ªè·¯ç”±ï¼‰
- â³ ç‰©æµå›è°ƒAPIï¼ˆ3ä¸ªè·¯ç”±ï¼‰
- â³ ç®¡ç†åå°å·¥å…·APIï¼ˆ5ä¸ªè·¯ç”±ï¼‰
- â³ äº§å“å°ºå¯¸ç®¡ç†ï¼ˆ1ä¸ªè·¯ç”±ï¼‰
- â³ äºŒç»´ç ç”Ÿæˆï¼ˆ1ä¸ªè·¯ç”±ï¼‰
- â³ è°ƒè¯•å’Œæµ‹è¯•è·¯ç”±ï¼ˆ4ä¸ªè·¯ç”±ï¼‰
- â³ æŠ–éŸ³å¼€æ”¾å¹³å°åŠŸèƒ½ï¼ˆ5ä¸ªè·¯ç”±ï¼‰

**æ€»è®¡**: çº¦ 56 ä¸ªè·¯ç”±å¾…æ‹†åˆ†

## ğŸ¯ æ‹†åˆ†å»ºè®®

### ç¬¬ä¸€é˜¶æ®µï¼šæ ¸å¿ƒä¸šåŠ¡æ¨¡å—ï¼ˆé«˜ä¼˜å…ˆçº§ï¼‰
1. æ”¯ä»˜ç›¸å…³è·¯ç”± â†’ `app/routes/payment.py`
2. ä¼˜æƒ åˆ¸ç›¸å…³è·¯ç”± â†’ `app/routes/coupon_api.py`
3. é¦–é¡µç®¡ç†API â†’ `app/routes/admin_homepage_api.py`
4. ç”¨æˆ·ç®¡ç†è·¯ç”± â†’ `app/routes/admin_users_api.py`
5. æ¶ˆæ¯é€šçŸ¥API â†’ `app/routes/admin_notification_api.py`

### ç¬¬äºŒé˜¶æ®µï¼šè¾…åŠ©åŠŸèƒ½æ¨¡å—ï¼ˆä¸­ä¼˜å…ˆçº§ï¼‰
6. ç‰©æµå›è°ƒAPI â†’ `app/routes/logistics_api.py`
7. ç®¡ç†åå°å·¥å…·API â†’ `app/routes/admin_tools_api.py`
8. äº§å“å°ºå¯¸ç®¡ç† â†’ `app/routes/admin.py` æˆ–æ–°å»º `admin_products_api.py`
9. äºŒç»´ç ç”Ÿæˆ â†’ `app/routes/qrcode_api.py`

### ç¬¬ä¸‰é˜¶æ®µï¼šå¯é€‰æ¨¡å—ï¼ˆä½ä¼˜å…ˆçº§ï¼‰
10. è°ƒè¯•å’Œæµ‹è¯•è·¯ç”± â†’ `app/routes/debug_api.py`ï¼ˆå¯é€‰ï¼‰
11. æŠ–éŸ³å¼€æ”¾å¹³å°åŠŸèƒ½ â†’ `app/routes/douyin_api.py`ï¼ˆå¯é€‰ï¼‰

## ğŸ“Š æ‹†åˆ†åé¢„æœŸ

### æ‹†åˆ†å®Œæˆå
- **test_server.py**: çº¦ 1,500-2,000 è¡Œï¼ˆåªä¿ç•™åº”ç”¨åˆå§‹åŒ–ã€è“å›¾æ³¨å†Œã€åˆå§‹åŒ–å‡½æ•°ï¼‰
- **æ–°å¢æ¨¡å—**: çº¦ 11 ä¸ªæ–°æ–‡ä»¶
- **ä»£ç ç»„ç»‡**: æ›´æ¸…æ™°ã€æ›´æ˜“ç»´æŠ¤

### å¿…é¡»ä¿ç•™åœ¨ test_server.py çš„å†…å®¹
1. Flaskåº”ç”¨åˆå§‹åŒ–ï¼ˆçº¦ 200 è¡Œï¼‰
2. æ•°æ®åº“åˆå§‹åŒ–ï¼ˆçº¦ 50 è¡Œï¼‰
3. è“å›¾æ³¨å†Œï¼ˆçº¦ 100 è¡Œï¼‰
4. åˆå§‹åŒ–å‡½æ•°ï¼ˆçº¦ 500 è¡Œï¼‰
5. åº”ç”¨å¯åŠ¨ä»£ç ï¼ˆçº¦ 50 è¡Œï¼‰
6. æ¨¡æ¿è¿‡æ»¤å™¨ï¼ˆå¯é€‰æ‹†åˆ†ï¼Œçº¦ 50 è¡Œï¼‰
7. è¾…åŠ©å‡½æ•°ï¼ˆå¯é€‰æ‹†åˆ†ï¼Œçº¦ 700 è¡Œï¼‰

**æ€»è®¡**: çº¦ 1,500-2,000 è¡Œï¼ˆåˆç†èŒƒå›´ï¼‰

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **æ‹†åˆ†é¡ºåº**: å»ºè®®æŒ‰ä¼˜å…ˆçº§åˆ†é˜¶æ®µæ‹†åˆ†ï¼Œæ¯æ‹†åˆ†ä¸€ä¸ªæ¨¡å—ç«‹å³æµ‹è¯•
2. **å‘åå…¼å®¹**: ç¡®ä¿æ‹†åˆ†åæ‰€æœ‰åŠŸèƒ½æ­£å¸¸
3. **æµ‹è¯•**: æ¯æ‹†åˆ†ä¸€ä¸ªæ¨¡å—ï¼Œå…¨é¢æµ‹è¯•ç›¸å…³åŠŸèƒ½
4. **æ¸…ç†**: æ‹†åˆ†å®Œæˆåï¼Œåˆ é™¤å·²æ³¨é‡Šçš„æ—§ä»£ç ï¼Œå‡å°æ–‡ä»¶å¤§å°
