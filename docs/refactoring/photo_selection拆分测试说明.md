# photo_selection.py 拆分测试说明

## 测试清单

拆分完成后，需要测试以下功能：

### 1. 订单列表功能
- [ ] 访问 `/admin/photo-selection`
- [ ] 检查订单列表是否正常显示
- [ ] 检查加盟商筛选功能
- [ ] 检查效果图数量统计

### 2. 订单详情功能
- [ ] 访问 `/admin/photo-selection/<order_id>`
- [ ] 检查效果图显示
- [ ] 检查套餐产品匹配
- [ ] 检查设计图片显示

### 3. 提交选片功能
- [ ] 提交选片结果
- [ ] 检查商城订单创建
- [ ] 检查订单状态更新
- [ ] 检查N+1查询优化

### 4. 确认选片功能
- [ ] 访问确认选片页面
- [ ] 检查产品选择功能
- [ ] 检查支付状态查询
- [ ] 检查跳过支付功能（测试模式）

### 5. 打印功能
- [ ] 启动打印任务
- [ ] 检查本地打印
- [ ] 检查远程打印
- [ ] 检查打印状态更新

### 6. 二维码功能
- [ ] 生成选片登录二维码
- [ ] 验证token功能
- [ ] 检查短token映射

### 7. 搜索功能
- [ ] 通过手机号搜索订单
- [ ] 通过订单号搜索订单
- [ ] 检查搜索结果

## 注意事项

1. **路由名称**: 所有路由已更新为使用子蓝图名称
2. **导入路径**: 确保所有模块导入正确
3. **权限检查**: 确保权限检查功能正常
4. **Token管理**: 确保token创建和验证功能正常

## 回滚方案

如果测试发现问题，可以：
1. 恢复原 `photo_selection.py` 文件
2. 在 `test_server.py` 中切换回原文件导入
3. 删除拆分后的模块目录

## 测试命令

```bash
# 启动服务器
python start.py

# 测试各个路由
# 1. 访问订单列表
curl http://127.0.0.1:8000/admin/photo-selection

# 2. 访问订单详情
curl http://127.0.0.1:8000/admin/photo-selection/1

# 3. 测试API接口
curl -X POST http://127.0.0.1:8000/api/photo-selection/search-orders \
  -H "Content-Type: application/json" \
  -d '{"phone": "13800138000", "franchisee_id": 1}'
```
