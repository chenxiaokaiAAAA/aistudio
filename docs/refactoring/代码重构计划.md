# ä»£ç é‡æ„å’Œæ¨¡å—åŒ–è®¡åˆ’

**åˆ›å»ºæ—¥æœŸ**: 2026-02-04  
**çŠ¶æ€**: ğŸ“‹ å‡†å¤‡å¼€å§‹

---

## ğŸ¯ é‡æ„ç›®æ ‡

1. **å‡å°‘ä»£ç é‡å¤**: ç»Ÿä¸€é‡å¤å®šä¹‰çš„å‡½æ•°
2. **æé«˜å¯ç»´æŠ¤æ€§**: æ‹†åˆ†è¶…å¤§æ–‡ä»¶
3. **æ¨¡å—åŒ–æ”¹è¿›**: åˆ›å»ºæœåŠ¡å±‚ï¼Œåˆ†ç¦»ä¸šåŠ¡é€»è¾‘

---

## ğŸ“‹ é‡æ„ä»»åŠ¡æ¸…å•

### ä»»åŠ¡1: ç»Ÿä¸€ `get_models()` å‡½æ•° â­â­â­

**é—®é¢˜**: 26ä¸ªæ–‡ä»¶é‡å¤å®šä¹‰ `get_models()` å‡½æ•°

**ç°çŠ¶**:
- âœ… å·²å­˜åœ¨ç»Ÿä¸€æ¨¡å—: `app/utils/admin_helpers.py`
- âœ… å·²å­˜åœ¨å°ç¨‹åºæ¨¡å—: `app/routes/miniprogram/common.py`
- âŒ å¤§éƒ¨åˆ†æ–‡ä»¶ä»ä½¿ç”¨æœ¬åœ°å®šä¹‰çš„ `get_models()`

**å½±å“æ–‡ä»¶** (26ä¸ª):
1. `app/routes/admin_homepage_api.py`
2. `app/routes/admin_product_categories_api.py`
3. `app/routes/admin_coupon_api.py`
4. `app/routes/admin_groupon_api.py`
5. `app/routes/admin_groupon_package_api.py`
6. `app/routes/debug_api.py`
7. `app/routes/merchant.py`
8. `app/routes/user_api.py`
9. `app/routes/miniprogram/refund.py`
10. `app/routes/franchisee/common.py`
11. `app/routes/user_api/visit.py`
12. `app/routes/user_api/promotion.py`
13. `app/routes/user_api/profile.py`
14. `app/routes/user_api/messages.py`
15. `app/routes/user_api/coupons.py`
16. `app/routes/user_api/commission.py`
17. `app/routes/user_api/auth.py`
18. `app/routes/promotion_api.py`
19. `app/routes/playground_api.py`
20. `app/routes/logistics_api.py`
21. `app/routes/media.py`
22. `app/routes/coupon_api.py`
23. `app/routes/admin_users_api.py`
24. `app/routes/admin_tools_api.py`
25. `app/routes/admin_third_party_groupon_api.py`
26. `app/routes/admin_shop_api.py`
27. `app/routes/admin_promotion_api.py`
28. `app/routes/admin_polling_config_api.py`
29. `app/routes/admin_notification_api.py`
30. `app/routes/admin_miniprogram_config_api.py`

**é‡æ„æ­¥éª¤**:
1. âœ… åˆ›å»ºå¤‡ä»½ï¼ˆå·²å®Œæˆï¼‰
2. åˆ†ææ¯ä¸ªæ–‡ä»¶çš„ `get_models()` å®ç°å·®å¼‚
3. ç»Ÿä¸€åˆ° `app/utils/admin_helpers.py`
4. é€ä¸ªæ–‡ä»¶æ›¿æ¢å¯¼å…¥
5. æµ‹è¯•æ¯ä¸ªæ–‡ä»¶æ˜¯å¦æ­£å¸¸å·¥ä½œ
6. åˆ é™¤æœ¬åœ° `get_models()` å®šä¹‰

**é¢„è®¡æ—¶é—´**: 2-3å°æ—¶

---

### ä»»åŠ¡2: ç»Ÿä¸€ `get_helper_functions()` å‡½æ•° â­â­

**é—®é¢˜**: å¤šä¸ªæ–‡ä»¶é‡å¤å®šä¹‰è¾…åŠ©å‡½æ•°è·å–é€»è¾‘

**ç°çŠ¶**:
- `app/routes/miniprogram/common.py` å·²æœ‰ `get_helper_functions()`
- å…¶ä»–æ–‡ä»¶å¯èƒ½ä¹Ÿæœ‰ç±»ä¼¼å®ç°

**é‡æ„æ­¥éª¤**:
1. åˆ†ææ‰€æœ‰ `get_helper_functions()` å®ç°
2. ç»Ÿä¸€åˆ°å…¬å…±æ¨¡å—
3. æ›¿æ¢å¯¼å…¥

**é¢„è®¡æ—¶é—´**: 1-2å°æ—¶

---

### ä»»åŠ¡3: æ‹†åˆ†è¶…å¤§æ–‡ä»¶ â­â­

**é—®é¢˜æ–‡ä»¶**:
1. `app/routes/admin_styles_workflow_api.py` (~2765è¡Œ)
2. `app/routes/admin_products_api.py` (~1179è¡Œ)
3. `app/routes/admin_orders_detail_api.py` (~1585è¡Œ)

**é‡æ„æ­¥éª¤**:
1. åˆ†ææ–‡ä»¶ç»“æ„ï¼Œç¡®å®šæ‹†åˆ†æ–¹æ¡ˆ
2. åˆ›å»ºå¤‡ä»½
3. æ‹†åˆ†æ–‡ä»¶ï¼ˆæŒ‰åŠŸèƒ½æ¨¡å—ï¼‰
4. æ›´æ–°å¯¼å…¥
5. æµ‹è¯•åŠŸèƒ½

**é¢„è®¡æ—¶é—´**: æ¯ä¸ªæ–‡ä»¶2-3å°æ—¶

---

## ğŸ”’ å®‰å…¨æªæ–½

### å¤‡ä»½ç­–ç•¥

1. **é‡æ„å‰å¤‡ä»½**:
   ```bash
   python scripts/backup/backup_before_refactor.py --backup
   ```

2. **æ¯æ­¥é‡æ„åå¤‡ä»½**:
   - å®Œæˆä¸€ä¸ªæ–‡ä»¶é‡æ„åï¼Œå†æ¬¡å¤‡ä»½
   - ç¡®ä¿å¯ä»¥å›é€€åˆ°ä»»ä½•ä¸€æ­¥

3. **æ¢å¤å¤‡ä»½**:
   ```bash
   # åˆ—å‡ºæ‰€æœ‰å¤‡ä»½
   python scripts/backup/backup_before_refactor.py --list
   
   # æ¢å¤æŒ‡å®šå¤‡ä»½
   python scripts/backup/restore_from_backup.py <timestamp>
   
   # æ¢å¤æœ€æ–°å¤‡ä»½
   python scripts/backup/restore_from_backup.py --latest
   ```

### æµ‹è¯•ç­–ç•¥

1. **é‡æ„å‰æµ‹è¯•**: ç¡®ä¿å½“å‰ä»£ç æ­£å¸¸å·¥ä½œ
2. **é‡æ„åæµ‹è¯•**: æ¯ä¸ªæ–‡ä»¶é‡æ„åç«‹å³æµ‹è¯•
3. **åŠŸèƒ½éªŒè¯**: ç¡®ä¿æ‰€æœ‰åŠŸèƒ½æ­£å¸¸

---

## ğŸ“ é‡æ„æ‰§è¡Œè®°å½•

### å·²å®Œæˆ
- âœ… åˆ›å»ºå¤‡ä»½è„šæœ¬
- âœ… åˆ›å»ºæ¢å¤è„šæœ¬
- âœ… åˆ›å»ºé‡æ„å‰å¤‡ä»½

### è¿›è¡Œä¸­
- ğŸ“‹ å‡†å¤‡å¼€å§‹ä»»åŠ¡1ï¼šç»Ÿä¸€ `get_models()` å‡½æ•°

### å¾…æ‰§è¡Œ
- â³ ä»»åŠ¡2ï¼šç»Ÿä¸€ `get_helper_functions()` å‡½æ•°
- â³ ä»»åŠ¡3ï¼šæ‹†åˆ†è¶…å¤§æ–‡ä»¶

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **é€æ­¥è¿›è¡Œ**: ä¸€æ¬¡åªé‡æ„ä¸€ä¸ªæ–‡ä»¶ï¼Œä¸è¦æ‰¹é‡ä¿®æ”¹
2. **å……åˆ†æµ‹è¯•**: æ¯ä¸ªæ–‡ä»¶é‡æ„åéƒ½è¦æµ‹è¯•
3. **ä¿ç•™å¤‡ä»½**: æ¯æ­¥éƒ½åˆ›å»ºå¤‡ä»½
4. **è®°å½•å˜æ›´**: è®°å½•æ¯ä¸ªæ–‡ä»¶çš„ä¿®æ”¹å†…å®¹

---

**æœ€åæ›´æ–°**: 2026-02-04  
**çŠ¶æ€**: ğŸ“‹ å‡†å¤‡å¼€å§‹é‡æ„
