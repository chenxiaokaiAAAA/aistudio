# 小程序二维码和订单详情修复说明

## 修复内容

### 1. 二维码页面添加后退按钮

**问题：** 二维码页面没有后退按钮，用户无法返回上一页。

**修复：**
- 在 `pages/order/qrcode.wxml` 中添加了导航栏
- 在 `pages/order/qrcode.js` 中添加了 `navigateBack()` 方法
- 在 `pages/order/qrcode.wxss` 中添加了导航栏样式

**修改文件：**
- `AI-小程序/pages/order/qrcode.wxml`
- `AI-小程序/pages/order/qrcode.js`
- `AI-小程序/pages/order/qrcode.wxss`

### 2. 订单详情页面显示自拍机拍摄的图片

**问题：** 
- 订单详情页面显示的是"用户上传原图"，但证件照订单的图片是安卓APP拍摄的
- 需要将标题改为"自拍机拍摄的图片"
- 需要确保证件照订单能正确显示安卓APP上传的图片

**修复：**
- 修改 `pages/order-detail/order-detail.wxml`：
  - 为证件照订单单独添加"自拍机拍摄的图片"区域
  - 标题改为"| 自拍机拍摄的图片"
  - 证件照订单始终显示此区域（不限制订单状态）
  - 非证件照订单继续显示"用户上传原图"区域

**显示逻辑：**
- **证件照订单**：显示"自拍机拍摄的图片"区域，始终显示（不管订单状态）
- **其他订单**：显示"用户上传原图"区域，只在订单未完成时显示

**图片数据来源：**
- 从服务器订单接口返回的 `images` 字段
- 安卓APP通过 `/api/miniprogram/order/upload` 上传的图片会保存到 `OrderImage` 表
- 订单查询接口会返回这些图片的URL列表

## 需要重新编译

### 小程序（需要重新编译）
在微信开发者工具中：
1. 点击"编译"按钮（或按 `Ctrl+B`）
2. 或者：点击"清除缓存" → "重新编译"

## 测试步骤

1. **测试二维码页面后退按钮**：
   - 进入订单列表
   - 点击"显示二维码"按钮
   - 应该能看到导航栏和后退按钮
   - 点击后退按钮应该能返回订单列表

2. **测试订单详情图片显示**：
   - 在小程序中创建证件照订单
   - 在安卓APP中拍摄并上传图片
   - 在小程序中查看订单详情
   - 应该能看到"自拍机拍摄的图片"区域
   - 应该能看到安卓APP上传的图片

## 注意事项

1. **图片显示条件**：
   - 证件照订单：始终显示"自拍机拍摄的图片"区域
   - 其他订单：只在订单未完成时显示"用户上传原图"区域

2. **图片数据更新**：
   - 订单详情页面在 `onShow()` 时会重新加载订单数据
   - 安卓APP上传图片后，刷新订单详情页面即可看到新图片

3. **图片URL处理**：
   - 代码会自动将HTTP URL转换为HTTPS（如果需要）
   - 图片URL来自服务器返回的 `images` 字段
