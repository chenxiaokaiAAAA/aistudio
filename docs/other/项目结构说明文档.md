# é¡¹ç›®ç»“æ„è¯´æ˜æ–‡æ¡£

## ğŸ“‹ ç›®å½•

1. [ç®¡ç†åå°é¡µé¢ç»“æ„](#ç®¡ç†åå°é¡µé¢ç»“æ„)
2. [å°ç¨‹åºç«¯æ¥å£](#å°ç¨‹åºç«¯æ¥å£)
3. [APPäº¤äº’æ¥å£](#appäº¤äº’æ¥å£)
4. [åŠ ç›Ÿå•†ç³»ç»Ÿæ¥å£](#åŠ ç›Ÿå•†ç³»ç»Ÿæ¥å£)
5. [è·¯ç”±æ³¨å†Œè¯´æ˜](#è·¯ç”±æ³¨å†Œè¯´æ˜)
6. [æ–‡ä»¶ç»“æ„æ€»ç»“](#æ–‡ä»¶ç»“æ„æ€»ç»“)
7. [å¿«é€Ÿç´¢å¼•](#å¿«é€Ÿç´¢å¼•)

---

## ç®¡ç†åå°é¡µé¢ç»“æ„

### 1. ä»ªè¡¨ç›˜ï¼ˆDashboardï¼‰

**è®¿é—®è·¯å¾„**: `/admin/dashboard`

**è·¯ç”±æ–‡ä»¶**: 
- `app/routes/admin.py` - é¡µé¢è·¯ç”±
- `app/routes/admin_dashboard_api.py` - APIæ¥å£

**æ¨¡æ¿æ–‡ä»¶**: 
- `templates/admin/dashboard.html`

**åŠŸèƒ½è¯´æ˜**: 
- æ˜¾ç¤ºç³»ç»Ÿæ¦‚è§ˆæ•°æ®
- è®¢å•ç»Ÿè®¡ã€ç”¨æˆ·ç»Ÿè®¡ç­‰

---

### 2. è®¢å•ç®¡ç†

#### 2.1 è®¢å•ç®¡ç†ï¼ˆä¸»é¡µé¢ï¼‰

**è®¿é—®è·¯å¾„**: `/admin/orders`

**è·¯ç”±æ–‡ä»¶**: 
- `app/routes/admin_orders.py` - é¡µé¢è·¯ç”±å’ŒAPI

**æ¨¡æ¿æ–‡ä»¶**: 
- `templates/admin/orders.html` - è®¢å•åˆ—è¡¨
- `templates/admin/order_details.html` - è®¢å•è¯¦æƒ…

**åŠŸèƒ½è¯´æ˜**: 
- æŸ¥çœ‹æ‰€æœ‰è®¢å•
- è®¢å•ç­›é€‰ï¼ˆæŒ‰çŠ¶æ€ã€åŠ ç›Ÿå•†ç­‰ï¼‰
- è®¢å•è¯¦æƒ…æŸ¥çœ‹
- è®¢å•çŠ¶æ€ç®¡ç†

#### 2.2 å•†åŸè®¢å•

**è®¿é—®è·¯å¾„**: `/admin/shop/orders`

**è·¯ç”±æ–‡ä»¶**: 
- `app/routes/admin_shop_api.py` - å•†åŸè®¢å•ç®¡ç†

**æ¨¡æ¿æ–‡ä»¶**: 
- `templates/admin/shop_orders.html` - å•†åŸè®¢å•åˆ—è¡¨
- `templates/admin/shop_order_detail.html` - å•†åŸè®¢å•è¯¦æƒ…

**åŠŸèƒ½è¯´æ˜**: 
- å•†åŸè®¢å•ç®¡ç†
- å•†åŸè®¢å•çŠ¶æ€è·Ÿè¸ª

---

### 3. é€‰ç‰‡é¡µé¢

**è®¿é—®è·¯å¾„**: `/admin/photo-selection`

**è·¯ç”±æ–‡ä»¶**: 
- `app/routes/photo_selection.py` - é€‰ç‰‡ç›¸å…³è·¯ç”±

**æ¨¡æ¿æ–‡ä»¶**: 
- `templates/admin/photo_selection_list.html` - é€‰ç‰‡åˆ—è¡¨
- `templates/admin/photo_selection_detail.html` - é€‰ç‰‡è¯¦æƒ…
- `templates/admin/photo_selection_confirm.html` - é€‰ç‰‡ç¡®è®¤

**åŠŸèƒ½è¯´æ˜**: 
- ç”¨æˆ·ä¸Šä¼ ç…§ç‰‡çš„é€‰ç‰‡ç®¡ç†
- é€‰ç‰‡ç¡®è®¤å’Œå®¡æ ¸

---

### 4. åŠ ç›Ÿå•†ç®¡ç†

**è®¿é—®è·¯å¾„**: `/franchisee/admin/accounts`

**è·¯ç”±æ–‡ä»¶**: 
- `app/routes/franchisee/admin.py` - åŠ ç›Ÿå•†ç®¡ç†è·¯ç”±

**æ¨¡æ¿æ–‡ä»¶**: 
- `templates/admin/franchisee_list.html` - åŠ ç›Ÿå•†åˆ—è¡¨
- `templates/admin/franchisee_detail.html` - åŠ ç›Ÿå•†è¯¦æƒ…
- `templates/admin/franchisee_edit.html` - åŠ ç›Ÿå•†ç¼–è¾‘
- `templates/admin/franchisee_add.html` - æ·»åŠ åŠ ç›Ÿå•†
- `templates/admin/franchisee_recharge.html` - åŠ ç›Ÿå•†å……å€¼

**åŠŸèƒ½è¯´æ˜**: 
- åŠ ç›Ÿå•†è´¦æˆ·ç®¡ç†
- åŠ ç›Ÿå•†å……å€¼
- åŠ ç›Ÿå•†è®¢å•æŸ¥çœ‹

---

### 5. äº§å“ç®¡ç†

#### 5.1 äº§å“ç®¡ç†ï¼ˆä¸»é¡µé¢ï¼‰

**è®¿é—®è·¯å¾„**: `/admin/sizes`

**è·¯ç”±æ–‡ä»¶**: 
- `app/routes/admin_products_api.py` - äº§å“ç®¡ç†è·¯ç”±

**æ¨¡æ¿æ–‡ä»¶**: 
- `templates/admin/sizes.html`

**åŠŸèƒ½è¯´æ˜**: 
- äº§å“é…ç½®
- äº§å“å°ºå¯¸ç®¡ç†
- äº§å“å›¾ç‰‡ç®¡ç†
- äº§å“ä»·æ ¼è®¾ç½®

#### 5.2 å•†åŸäº§å“

**è®¿é—®è·¯å¾„**: `/admin/shop/products`

**è·¯ç”±æ–‡ä»¶**: 
- `app/routes/admin_shop_api.py` - å•†åŸäº§å“ç®¡ç†

**æ¨¡æ¿æ–‡ä»¶**: 
- `templates/admin/shop_products.html`

**åŠŸèƒ½è¯´æ˜**: 
- å•†åŸäº§å“é…ç½®
- å•†åŸäº§å“å°ºå¯¸ç®¡ç†

---

### 6. é£æ ¼ç®¡ç†

**è®¿é—®è·¯å¾„**: `/admin/styles`

**è·¯ç”±æ–‡ä»¶**: 
- `app/routes/admin.py` - é¡µé¢è·¯ç”±
- `app/routes/admin_styles_api.py` - é£æ ¼ç®¡ç†API

**æ¨¡æ¿æ–‡ä»¶**: 
- `templates/admin/styles.html`

**åŠŸèƒ½è¯´æ˜**: 
- é£æ ¼åˆ†ç±»ç®¡ç†
- é£æ ¼å›¾ç‰‡ç®¡ç†
- é£æ ¼ä»£ç é…ç½®

---

### 7. AIä»»åŠ¡ç®¡ç†

**è®¿é—®è·¯å¾„**: `/admin/ai/tasks`

**è·¯ç”±æ–‡ä»¶**: 
- `app/routes/ai.py` - AIä»»åŠ¡ç®¡ç†è·¯ç”±

**æ¨¡æ¿æ–‡ä»¶**: 
- `templates/admin/ai_tasks.html`

**åŠŸèƒ½è¯´æ˜**: 
- AIä»»åŠ¡åˆ—è¡¨
- AIä»»åŠ¡çŠ¶æ€æŸ¥çœ‹
- AIä»»åŠ¡é‡è¯•

---

### 8. ç¾é¢œä»»åŠ¡ç®¡ç†

**è®¿é—®è·¯å¾„**: `/admin/meitu/tasks`

**è·¯ç”±æ–‡ä»¶**: 
- `app/routes/meitu.py` - ç¾é¢œä»»åŠ¡ç®¡ç†è·¯ç”±

**æ¨¡æ¿æ–‡ä»¶**: 
- `templates/admin/meitu_tasks.html`

**åŠŸèƒ½è¯´æ˜**: 
- ç¾é¢œä»»åŠ¡åˆ—è¡¨
- ç¾é¢œä»»åŠ¡çŠ¶æ€æŸ¥çœ‹

---

### 9. ç³»ç»Ÿé…ç½®

#### 9.1 ç³»ç»Ÿé…ç½®ï¼ˆä¸»é¡µé¢ï¼‰

**è®¿é—®è·¯å¾„**: `/admin/system-config`

**è·¯ç”±æ–‡ä»¶**: 
- `app/routes/admin.py` - é¡µé¢è·¯ç”±
- `app/routes/admin_tools_api.py` - ç³»ç»Ÿé…ç½®API

**æ¨¡æ¿æ–‡ä»¶**: 
- `templates/admin/system_config.html`

**åŠŸèƒ½è¯´æ˜**: 
- ç³»ç»ŸåŸºç¡€é…ç½®
- å¹¶å‘é…ç½®
- å…¶ä»–ç³»ç»Ÿå‚æ•°

#### 9.2 ç¾é¢œAPIé…ç½®

**è®¿é—®è·¯å¾„**: `/admin/meitu/config`

**è·¯ç”±æ–‡ä»¶**: 
- `app/routes/meitu.py` - ç¾é¢œAPIé…ç½®è·¯ç”±

**æ¨¡æ¿æ–‡ä»¶**: 
- `templates/admin/meitu_api_config.html`

**åŠŸèƒ½è¯´æ˜**: 
- ç¾é¢œAPIå¯†é’¥é…ç½®
- ç¾é¢œAPIå‚æ•°è®¾ç½®

#### 9.3 APIæœåŠ¡å•†é…ç½®

**è®¿é—®è·¯å¾„**: `/admin/ai-provider/config`

**è·¯ç”±æ–‡ä»¶**: 
- `app/routes/ai_provider.py` - APIæœåŠ¡å•†é…ç½®è·¯ç”±

**æ¨¡æ¿æ–‡ä»¶**: 
- `templates/admin/api_provider_config.html`

**åŠŸèƒ½è¯´æ˜**: 
- AIæœåŠ¡å•†é…ç½®
- APIå¯†é’¥ç®¡ç†
- æœåŠ¡å•†åˆ‡æ¢

#### 9.4 è¿‡æœŸå›¾ç‰‡æ¸…ç†

**è®¿é—®è·¯å¾„**: `/admin/image-cleanup`

**è·¯ç”±æ–‡ä»¶**: 
- `app/routes/admin_image_cleanup.py` - å›¾ç‰‡æ¸…ç†è·¯ç”±

**æ¨¡æ¿æ–‡ä»¶**: 
- `templates/admin/image_cleanup.html`

**åŠŸèƒ½è¯´æ˜**: 
- æ¸…ç†è¿‡æœŸå›¾ç‰‡
- å›¾ç‰‡å­˜å‚¨ç®¡ç†

#### 9.5 æ‰“å°é…ç½®

**è®¿é—®è·¯å¾„**: `/admin/print-config`

**è·¯ç”±æ–‡ä»¶**: 
- `app/routes/admin_tools_api.py` - æ‰“å°é…ç½®è·¯ç”±

**æ¨¡æ¿æ–‡ä»¶**: 
- `templates/admin/print_config.html`

**åŠŸèƒ½è¯´æ˜**: 
- æ‰“å°å°ºå¯¸é…ç½®
- æ‰“å°å‚æ•°è®¾ç½®

#### 9.6 æ‰“å°æœºç®¡ç†

**è®¿é—®è·¯å¾„**: `/admin/printer`

**è·¯ç”±æ–‡ä»¶**: 
- `app/routes/admin_tools_api.py` - æ‰“å°æœºç®¡ç†è·¯ç”±

**æ¨¡æ¿æ–‡ä»¶**: 
- `templates/admin/printer.html`

**åŠŸèƒ½è¯´æ˜**: 
- æ‰“å°æœºé…ç½®
- æ‰“å°æœºçŠ¶æ€ç®¡ç†

---

### 10. å°ç¨‹åºç®¡ç†

#### 10.1 ä¼˜æƒ åˆ¸ç®¡ç†

**è®¿é—®è·¯å¾„**: `/admin/coupons`

**è·¯ç”±æ–‡ä»¶**: 
- `app/routes/admin_coupon_api.py` - ä¼˜æƒ åˆ¸ç®¡ç†è·¯ç”±

**æ¨¡æ¿æ–‡ä»¶**: 
- `templates/admin/coupons.html`

**åŠŸèƒ½è¯´æ˜**: 
- ä¼˜æƒ åˆ¸åˆ›å»º
- ä¼˜æƒ åˆ¸åˆ—è¡¨
- ä¼˜æƒ åˆ¸ä½¿ç”¨ç»Ÿè®¡

#### 10.2 å°ç¨‹åºç”¨æˆ·ç®¡ç†

**è®¿é—®è·¯å¾„**: `/admin/promotion`

**è·¯ç”±æ–‡ä»¶**: 
- `app/routes/admin_promotion_api.py` - æ¨å¹¿ç”¨æˆ·ç®¡ç†è·¯ç”±

**æ¨¡æ¿æ–‡ä»¶**: 
- `templates/admin/promotion_management.html`

**åŠŸèƒ½è¯´æ˜**: 
- å°ç¨‹åºç”¨æˆ·åˆ—è¡¨
- æ¨å¹¿å…³ç³»ç®¡ç†
- æ¨å¹¿æ”¶ç›Šç»Ÿè®¡

#### 10.3 é¦–é¡µé…ç½®

**è®¿é—®è·¯å¾„**: `/admin/homepage`

**è·¯ç”±æ–‡ä»¶**: 
- `app/routes/admin.py` - é¡µé¢è·¯ç”±
- `app/routes/admin_homepage_api.py` - é¦–é¡µé…ç½®API

**æ¨¡æ¿æ–‡ä»¶**: 
- `templates/admin/homepage.html`

**åŠŸèƒ½è¯´æ˜**: 
- é¦–é¡µè½®æ’­å›¾é…ç½®
- é¦–é¡µå†…å®¹ç®¡ç†

---

### 11. ä¸ªäººä¸­å¿ƒ

**è®¿é—®è·¯å¾„**: `/admin/profile`

**è·¯ç”±æ–‡ä»¶**: 
- `app/routes/admin_profile.py` - ä¸ªäººä¸­å¿ƒè·¯ç”±

**æ¨¡æ¿æ–‡ä»¶**: 
- `templates/admin/profile.html`

**åŠŸèƒ½è¯´æ˜**: 
- ä¸ªäººä¿¡æ¯ä¿®æ”¹
- å¯†ç ä¿®æ”¹

---

### 12. å…¶ä»–ç®¡ç†é¡µé¢

#### 12.1 å‘˜å·¥ç®¡ç†

**è®¿é—®è·¯å¾„**: `/admin/staff` (é€šè¿‡APIè®¿é—®)

**è·¯ç”±æ–‡ä»¶**: 
- `app/routes/staff_permission.py` - å‘˜å·¥æƒé™ç®¡ç†

**æ¨¡æ¿æ–‡ä»¶**: 
- `templates/admin/staff_list.html` - å‘˜å·¥åˆ—è¡¨
- `templates/admin/staff_add.html` - æ·»åŠ å‘˜å·¥
- `templates/admin/staff_edit.html` - ç¼–è¾‘å‘˜å·¥

**åŠŸèƒ½è¯´æ˜**: 
- å‘˜å·¥è´¦æˆ·ç®¡ç†
- å‘˜å·¥æƒé™é…ç½®

#### 12.2 å•†å®¶ç®¡ç†

**è®¿é—®è·¯å¾„**: `/merchant/dashboard` (å•†å®¶ç«¯)

**è·¯ç”±æ–‡ä»¶**: 
- `app/routes/merchant.py` - å•†å®¶ç®¡ç†è·¯ç”±

**æ¨¡æ¿æ–‡ä»¶**: 
- `templates/merchant/dashboard.html` - å•†å®¶ä»ªè¡¨ç›˜
- `templates/admin/merchants.html` - å•†å®¶åˆ—è¡¨
- `templates/admin/merchant_details.html` - å•†å®¶è¯¦æƒ…
- `templates/admin/merchant_edit.html` - å•†å®¶ç¼–è¾‘
- `templates/admin/add_merchant.html` - æ·»åŠ å•†å®¶

**åŠŸèƒ½è¯´æ˜**: 
- å•†å®¶è´¦æˆ·ç®¡ç†
- å•†å®¶è®¢å•æŸ¥çœ‹

---

## å°ç¨‹åºç«¯æ¥å£

### åŸºç¡€è·¯å¾„
æ‰€æœ‰å°ç¨‹åºæ¥å£çš„åŸºç¡€è·¯å¾„ä¸º: `/api/miniprogram`

### 1. ç›®å½•ç›¸å…³æ¥å£ï¼ˆCatalogï¼‰

**è·¯ç”±æ–‡ä»¶**: `app/routes/miniprogram/catalog.py`

**æ¥å£åˆ—è¡¨**:

- `GET /api/miniprogram/styles` - è·å–é£æ ¼åˆ†ç±»åˆ—è¡¨
  - æ”¯æŒæŒ‰äº§å“IDè¿‡æ»¤: `?productId=xxx`
  - è¿”å›é£æ ¼åˆ†ç±»å’Œé£æ ¼å›¾ç‰‡

- `GET /api/miniprogram/products` - è·å–äº§å“åˆ—è¡¨
  - è¿”å›æ‰€æœ‰å¯ç”¨çš„äº§å“åŠå…¶å°ºå¯¸ä¿¡æ¯

- `GET /api/miniprogram/banners` - è·å–é¦–é¡µè½®æ’­å›¾
  - è¿”å›é¦–é¡µé…ç½®çš„è½®æ’­å›¾åˆ—è¡¨

---

### 2. è®¢å•ç›¸å…³æ¥å£ï¼ˆOrdersï¼‰

**è·¯ç”±æ–‡ä»¶**: `app/routes/miniprogram/orders.py`

**æ¥å£åˆ—è¡¨**:

- `POST /api/miniprogram/orders` - æäº¤è®¢å•
  - åˆ›å»ºæ–°è®¢å•
  - è¿”å›è®¢å•å·å’Œæ”¯ä»˜ä¿¡æ¯

- `GET /api/miniprogram/orders` - è·å–è®¢å•åˆ—è¡¨
  - æ”¯æŒæŒ‰openidã€userIdã€phoneæŸ¥è¯¢
  - è¿”å›ç”¨æˆ·çš„æ‰€æœ‰è®¢å•

- `GET /api/miniprogram/orders/<order_id>` - è·å–è®¢å•è¯¦æƒ…
  - è¿”å›è®¢å•çš„è¯¦ç»†ä¿¡æ¯

- `POST /api/miniprogram/orders/<order_id>/upload` - ä¸Šä¼ è®¢å•ç…§ç‰‡
  - ä¸Šä¼ ç”¨æˆ·ç…§ç‰‡åˆ°è®¢å•

- `GET /api/miniprogram/orders/<order_id>/qrcode` - è·å–è®¢å•äºŒç»´ç 
  - è¿”å›è®¢å•çš„äºŒç»´ç å›¾ç‰‡ï¼ˆbase64ï¼‰

- `POST /api/miniprogram/orders/<order_id>/verify` - éªŒè¯è®¢å•
  - éªŒè¯è®¢å•çŠ¶æ€

---

### 3. ä½œå“ç›¸å…³æ¥å£ï¼ˆWorksï¼‰

**è·¯ç”±æ–‡ä»¶**: `app/routes/miniprogram/works.py`

**æ¥å£åˆ—è¡¨**:

- `GET /api/miniprogram/works` - è·å–ä½œå“åˆ—è¡¨
  - è¿”å›ç”¨æˆ·çš„ä½œå“åˆ—è¡¨

- `GET /api/miniprogram/works/<work_id>` - è·å–ä½œå“è¯¦æƒ…
  - è¿”å›ä½œå“çš„è¯¦ç»†ä¿¡æ¯

---

### 4. åª’ä½“ç›¸å…³æ¥å£ï¼ˆMediaï¼‰

**è·¯ç”±æ–‡ä»¶**: `app/routes/miniprogram/media.py`

**æ¥å£åˆ—è¡¨**:

- `POST /api/miniprogram/media/upload` - ä¸Šä¼ åª’ä½“æ–‡ä»¶
  - ä¸Šä¼ å›¾ç‰‡ã€è§†é¢‘ç­‰åª’ä½“æ–‡ä»¶

- `GET /api/miniprogram/media/<media_id>` - è·å–åª’ä½“æ–‡ä»¶
  - è¿”å›åª’ä½“æ–‡ä»¶çš„URLæˆ–å†…å®¹

---

### 5. æ¨å¹¿ç›¸å…³æ¥å£ï¼ˆPromotionï¼‰

**è·¯ç”±æ–‡ä»¶**: `app/routes/miniprogram/promotion.py`

**æ¥å£åˆ—è¡¨**:

- `GET /api/miniprogram/promotion-code` - è·å–æ¨å¹¿ç 
  - è·å–ç”¨æˆ·çš„æ¨å¹¿ç 

- `POST /api/miniprogram/promotion-code/use` - ä½¿ç”¨æ¨å¹¿ç 
  - ä½¿ç”¨æ¨å¹¿ç ç»‘å®šæ¨å¹¿å…³ç³»

- `GET /api/miniprogram/promotion/stats` - è·å–æ¨å¹¿ç»Ÿè®¡
  - è¿”å›æ¨å¹¿æ”¶ç›Šç»Ÿè®¡

---

### 6. å•†åŸç›¸å…³æ¥å£ï¼ˆShopï¼‰

**è·¯ç”±æ–‡ä»¶**: `app/routes/miniprogram/shop.py`

**æ¥å£åˆ—è¡¨**:

- `GET /api/miniprogram/shop/products` - è·å–å•†åŸäº§å“åˆ—è¡¨
  - è¿”å›æ‰€æœ‰å¯ç”¨çš„å•†åŸäº§å“

- `GET /api/miniprogram/shop/products/<product_id>` - è·å–å•†åŸäº§å“è¯¦æƒ…
  - è¿”å›äº§å“çš„è¯¦ç»†ä¿¡æ¯

- `POST /api/miniprogram/shop/orders` - æäº¤å•†åŸè®¢å•
  - åˆ›å»ºå•†åŸè®¢å•

- `GET /api/miniprogram/shop/orders` - è·å–å•†åŸè®¢å•åˆ—è¡¨
  - è¿”å›ç”¨æˆ·çš„å•†åŸè®¢å•åˆ—è¡¨

---

### 7. ä¼˜æƒ åˆ¸ç›¸å…³æ¥å£ï¼ˆCouponï¼‰

**è·¯ç”±æ–‡ä»¶**: `app/routes/coupon_api.py`

**æ¥å£åˆ—è¡¨**:

- `GET /api/coupons` - è·å–å¯ç”¨ä¼˜æƒ åˆ¸åˆ—è¡¨
  - è¿”å›ç”¨æˆ·å¯ç”¨çš„ä¼˜æƒ åˆ¸

- `POST /api/coupons/<coupon_id>/get` - é¢†å–ä¼˜æƒ åˆ¸
  - ç”¨æˆ·é¢†å–ä¼˜æƒ åˆ¸

- `POST /api/coupons/<coupon_id>/use` - ä½¿ç”¨ä¼˜æƒ åˆ¸
  - åœ¨è®¢å•ä¸­ä½¿ç”¨ä¼˜æƒ åˆ¸

---

### 8. æ•°å­—äººåƒç›¸å…³æ¥å£ï¼ˆDigital Avatarï¼‰

**è·¯ç”±æ–‡ä»¶**: `app/routes/miniprogram/digital_avatar.py`

**æ¥å£åˆ—è¡¨**:

- `POST /api/miniprogram/digital-avatar/create` - åˆ›å»ºæ•°å­—äººåƒ
  - åˆ›å»ºæ•°å­—äººåƒä»»åŠ¡

- `GET /api/miniprogram/digital-avatar/<task_id>` - è·å–æ•°å­—äººåƒä»»åŠ¡çŠ¶æ€
  - æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€

---

### 9. åˆ†äº«å¥–åŠ±ç›¸å…³æ¥å£ï¼ˆShare Rewardï¼‰

**è·¯ç”±æ–‡ä»¶**: `app/routes/miniprogram/share_reward.py`

**æ¥å£åˆ—è¡¨**:

- `GET /api/miniprogram/share-reward/info` - è·å–åˆ†äº«å¥–åŠ±ä¿¡æ¯
  - è¿”å›åˆ†äº«å¥–åŠ±é…ç½®

- `POST /api/miniprogram/share-reward/claim` - é¢†å–åˆ†äº«å¥–åŠ±
  - é¢†å–åˆ†äº«å¥–åŠ±

---

### 10. æ‹¼å›¢ç›¸å…³æ¥å£ï¼ˆGrouponï¼‰

**è·¯ç”±æ–‡ä»¶**: `app/routes/miniprogram/groupon.py`

**æ¥å£åˆ—è¡¨**:

- `GET /api/miniprogram/groupon/activities` - è·å–æ‹¼å›¢æ´»åŠ¨åˆ—è¡¨
  - è¿”å›æ‰€æœ‰æ‹¼å›¢æ´»åŠ¨

- `POST /api/miniprogram/groupon/join` - å‚ä¸æ‹¼å›¢
  - ç”¨æˆ·å‚ä¸æ‹¼å›¢æ´»åŠ¨

- `GET /api/miniprogram/groupon/<groupon_id>` - è·å–æ‹¼å›¢è¯¦æƒ…
  - è¿”å›æ‹¼å›¢æ´»åŠ¨çš„è¯¦ç»†ä¿¡æ¯

---

### 11. ç¬¬ä¸‰æ–¹æ‹¼å›¢æ¥å£ï¼ˆThird Party Grouponï¼‰

**è·¯ç”±æ–‡ä»¶**: `app/routes/miniprogram/third_party_groupon.py`

**æ¥å£åˆ—è¡¨**:

- `GET /api/miniprogram/third-party-groupon/activities` - è·å–ç¬¬ä¸‰æ–¹æ‹¼å›¢æ´»åŠ¨
  - è¿”å›ç¬¬ä¸‰æ–¹æ‹¼å›¢æ´»åŠ¨åˆ—è¡¨

- `POST /api/miniprogram/third-party-groupon/join` - å‚ä¸ç¬¬ä¸‰æ–¹æ‹¼å›¢
  - å‚ä¸ç¬¬ä¸‰æ–¹æ‹¼å›¢æ´»åŠ¨

---

## APPäº¤äº’æ¥å£

### åŸºç¡€è·¯å¾„
APPæ¥å£çš„åŸºç¡€è·¯å¾„ä¸º: `/api`

### 1. ç”¨æˆ·ç›¸å…³æ¥å£

**è·¯ç”±æ–‡ä»¶**: `app/routes/user_api.py`

**æ¥å£åˆ—è¡¨**:

- `POST /api/user/openid` - è·å–ç”¨æˆ·openidï¼ˆé€šè¿‡å¾®ä¿¡codeï¼‰
- `POST /api/user/phone` - è·å–ç”¨æˆ·æ‰‹æœºå·ï¼ˆè§£å¯†ï¼‰
- `POST /api/user/register` - ç”¨æˆ·æ³¨å†Œ
- `GET /api/user/info` - è·å–ç”¨æˆ·ä¿¡æ¯
- `POST /api/user/update` - æ›´æ–°ç”¨æˆ·ä¿¡æ¯
- `GET /api/user/visits` - è·å–ç”¨æˆ·è®¿é—®è®°å½•
- `GET /api/user/commissions` - è·å–ç”¨æˆ·æ¨å¹¿æ”¶ç›Š
- `POST /api/user/withdraw` - ç”³è¯·æç°
- `GET /api/user/withdrawals` - è·å–æç°è®°å½•

---

### 2. æ”¯ä»˜ç›¸å…³æ¥å£

**è·¯ç”±æ–‡ä»¶**: `app/routes/payment.py`

**æ¥å£åˆ—è¡¨**:

- `POST /api/payment/create` - åˆ›å»ºæ”¯ä»˜è®¢å•
  - æ”¯æŒä¼˜æƒ åˆ¸ä½¿ç”¨
  - æ”¯æŒè·³è¿‡æ”¯ä»˜ï¼ˆå¼€å‘æ¨¡å¼ï¼‰
  - è¿”å›å¾®ä¿¡æ”¯ä»˜å‚æ•°

- `POST /api/payment/notify` - æ”¯ä»˜å›è°ƒé€šçŸ¥
  - å¾®ä¿¡æ”¯ä»˜å›è°ƒæ¥å£
  - å¤„ç†æ”¯ä»˜æˆåŠŸåçš„è®¢å•çŠ¶æ€æ›´æ–°

---

### 3. è®¢å•ç›¸å…³æ¥å£

**è·¯ç”±æ–‡ä»¶**: `app/routes/order.py`

**æ¥å£åˆ—è¡¨**:

- `GET /api/orders` - è·å–è®¢å•åˆ—è¡¨
- `GET /api/orders/<order_id>` - è·å–è®¢å•è¯¦æƒ…
- `POST /api/orders` - åˆ›å»ºè®¢å•

---

### 4. ç‰©æµç›¸å…³æ¥å£

**è·¯ç”±æ–‡ä»¶**: `app/routes/logistics_api.py`

**æ¥å£åˆ—è¡¨**:

- `GET /api/logistics/track` - æŸ¥è¯¢ç‰©æµä¿¡æ¯
- `POST /api/logistics/update` - æ›´æ–°ç‰©æµä¿¡æ¯

---

### 5. äºŒç»´ç ç›¸å…³æ¥å£

**è·¯ç”±æ–‡ä»¶**: `app/routes/qrcode_api.py`

**æ¥å£åˆ—è¡¨**:

- `POST /api/qrcode/generate` - ç”ŸæˆäºŒç»´ç 
- `GET /api/qrcode/<qrcode_id>` - è·å–äºŒç»´ç ä¿¡æ¯

---

### 6. æ¨å¹¿ç›¸å…³æ¥å£

**è·¯ç”±æ–‡ä»¶**: `app/routes/promotion_api.py`

**æ¥å£åˆ—è¡¨**:

- `GET /api/promotion/code` - è·å–æ¨å¹¿ç 
- `POST /api/promotion/bind` - ç»‘å®šæ¨å¹¿å…³ç³»
- `GET /api/promotion/stats` - è·å–æ¨å¹¿ç»Ÿè®¡

---

### 7. ä¼˜æƒ åˆ¸ç›¸å…³æ¥å£

**è·¯ç”±æ–‡ä»¶**: `app/routes/coupon_api.py`

**æ¥å£åˆ—è¡¨**:

- `GET /api/coupons` - è·å–å¯ç”¨ä¼˜æƒ åˆ¸åˆ—è¡¨
- `POST /api/coupons/<coupon_id>/get` - é¢†å–ä¼˜æƒ åˆ¸
- `POST /api/coupons/<coupon_id>/use` - ä½¿ç”¨ä¼˜æƒ åˆ¸

---

## åŠ ç›Ÿå•†ç³»ç»Ÿæ¥å£

### åŸºç¡€è·¯å¾„
åŠ ç›Ÿå•†ç³»ç»Ÿçš„åŸºç¡€è·¯å¾„ä¸º: `/franchisee`

### 1. åŠ ç›Ÿå•†å‰ç«¯é¡µé¢ï¼ˆFrontendï¼‰

**è·¯ç”±æ–‡ä»¶**: `app/routes/franchisee/frontend.py`

**é¡µé¢åˆ—è¡¨**:

- `GET /franchisee/login` - åŠ ç›Ÿå•†ç™»å½•é¡µé¢
  - æ¨¡æ¿: `templates/franchisee/login.html`

- `GET /franchisee/dashboard` - åŠ ç›Ÿå•†ä»ªè¡¨ç›˜
  - æ¨¡æ¿: `templates/franchisee/dashboard.html`
  - æ˜¾ç¤ºè®¢å•ç»Ÿè®¡ã€ä½™é¢ç­‰ä¿¡æ¯

- `GET /franchisee/orders` - åŠ ç›Ÿå•†è®¢å•åˆ—è¡¨
  - æ¨¡æ¿: `templates/franchisee/orders.html`
  - æŸ¥çœ‹è¯¥åŠ ç›Ÿå•†çš„æ‰€æœ‰è®¢å•

- `GET /franchisee/order/<order_id>` - åŠ ç›Ÿå•†è®¢å•è¯¦æƒ…
  - æ¨¡æ¿: `templates/franchisee/order.html`
  - æŸ¥çœ‹è®¢å•è¯¦ç»†ä¿¡æ¯

- `GET /franchisee/qrcode` - åŠ ç›Ÿå•†äºŒç»´ç 
  - æ¨¡æ¿: `templates/franchisee/qrcode.html`
  - æ˜¾ç¤ºåŠ ç›Ÿå•†äºŒç»´ç ï¼Œä¾›é—¨åº—æ‰«ç ä½¿ç”¨

- `GET /franchisee/recharge-records` - å……å€¼è®°å½•
  - æ¨¡æ¿: `templates/franchisee/recharge_records.html`
  - æŸ¥çœ‹å……å€¼å†å²è®°å½•

- `POST /franchisee/change-password` - ä¿®æ”¹å¯†ç 
  - æ¨¡æ¿: `templates/franchisee/change_password.html`

---

### 2. åŠ ç›Ÿå•†APIæ¥å£

**è·¯ç”±æ–‡ä»¶**: `app/routes/franchisee/api.py`

**æ¥å£åˆ—è¡¨**:

- `POST /franchisee/api/check-quota` - æ£€æŸ¥åŠ ç›Ÿå•†é¢åº¦
  - é€šè¿‡äºŒç»´ç æ£€æŸ¥é¢åº¦æ˜¯å¦å……è¶³

- `POST /franchisee/api/deduct-quota` - æ‰£é™¤åŠ ç›Ÿå•†é¢åº¦
  - è®¢å•æ”¯ä»˜æˆåŠŸåæ‰£é™¤é¢åº¦

- `GET /franchisee/api/account-info` - è·å–è´¦æˆ·ä¿¡æ¯
  - è¿”å›åŠ ç›Ÿå•†è´¦æˆ·ä½™é¢ç­‰ä¿¡æ¯

---

### 3. åŠ ç›Ÿå•†ç®¡ç†ï¼ˆç®¡ç†å‘˜ç«¯ï¼‰

**è·¯ç”±æ–‡ä»¶**: `app/routes/franchisee/admin.py`

**é¡µé¢åˆ—è¡¨**:

- `GET /franchisee/admin/accounts` - åŠ ç›Ÿå•†è´¦æˆ·åˆ—è¡¨
  - æ¨¡æ¿: `templates/admin/franchisee_list.html`

- `GET /franchisee/admin/accounts/<account_id>` - åŠ ç›Ÿå•†è¯¦æƒ…
  - æ¨¡æ¿: `templates/admin/franchisee_detail.html`

- `GET /franchisee/admin/accounts/<account_id>/edit` - ç¼–è¾‘åŠ ç›Ÿå•†
  - æ¨¡æ¿: `templates/admin/franchisee_edit.html`

- `GET /franchisee/admin/accounts/add` - æ·»åŠ åŠ ç›Ÿå•†
  - æ¨¡æ¿: `templates/admin/franchisee_add.html`

- `GET /franchisee/admin/accounts/<account_id>/recharge` - åŠ ç›Ÿå•†å……å€¼
  - æ¨¡æ¿: `templates/admin/franchisee_recharge.html`

---

## è·¯ç”±æ³¨å†Œè¯´æ˜

### ä¸»åº”ç”¨æ–‡ä»¶
- `test_server.py` - ä¸»åº”ç”¨å…¥å£ï¼Œæ³¨å†Œæ‰€æœ‰Blueprint

### Blueprintæ³¨å†Œé¡ºåº

åœ¨ `test_server.py` ä¸­ï¼Œæ‰€æœ‰BlueprintæŒ‰ä»¥ä¸‹é¡ºåºæ³¨å†Œï¼š

1. **åŸºç¡€è·¯ç”±**
   - `base_bp` - åŸºç¡€è·¯ç”±ï¼ˆé¦–é¡µç­‰ï¼‰

2. **è®¤è¯è·¯ç”±**
   - `auth_bp` - ç™»å½•è®¤è¯

3. **ç®¡ç†åå°è·¯ç”±**
   - `admin_bp` - ç®¡ç†åå°é¡µé¢è·¯ç”±
   - `admin_orders_bp` - è®¢å•ç®¡ç†
   - `admin_products_bp` - äº§å“ç®¡ç†
   - `admin_styles_api_bp` - é£æ ¼ç®¡ç†API
   - `admin_homepage_api_bp` - é¦–é¡µé…ç½®API
   - `admin_dashboard_api_bp` - ä»ªè¡¨ç›˜API
   - `admin_coupon_api_bp` - ä¼˜æƒ åˆ¸ç®¡ç†API
   - `admin_promotion_api_bp` - æ¨å¹¿ç®¡ç†API
   - `admin_users_api_bp` - ç”¨æˆ·ç®¡ç†API
   - `admin_notification_api_bp` - é€šçŸ¥ç®¡ç†API
   - `admin_tools_api_bp` - å·¥å…·API
   - `admin_shop_bp` - å•†åŸç®¡ç†
   - `admin_groupon_api_bp` - æ‹¼å›¢ç®¡ç†API
   - `admin_third_party_groupon_api_bp` - ç¬¬ä¸‰æ–¹æ‹¼å›¢API
   - `admin_image_cleanup_bp` - å›¾ç‰‡æ¸…ç†
   - `admin_profile_bp` - ä¸ªäººä¸­å¿ƒ

4. **å•†å®¶è·¯ç”±**
   - `merchant_bp` - å•†å®¶ç®¡ç†

5. **åŠ ç›Ÿå•†è·¯ç”±**
   - `franchisee_bp` - åŠ ç›Ÿå•†ç®¡ç†ï¼ˆåŒ…å«adminã€frontendã€apiå­è“å›¾ï¼‰

6. **åª’ä½“è·¯ç”±**
   - `media_bp` - åª’ä½“æ–‡ä»¶å¤„ç†

7. **å°ç¨‹åºè·¯ç”±**
   - `miniprogram_bp` - å°ç¨‹åºAPIï¼ˆåŒ…å«å¤šä¸ªå­æ¨¡å—ï¼‰

8. **è®¢å•è·¯ç”±**
   - `order_bp` - è®¢å•å¤„ç†

9. **æ”¯ä»˜è·¯ç”±**
   - `payment_bp` - æ”¯ä»˜å¤„ç†
   - `user_bp` - ç”¨æˆ·ç›¸å…³

10. **AIç›¸å…³è·¯ç”±**
    - `ai_bp` - AIä»»åŠ¡ç®¡ç†
    - `meitu_bp` - ç¾é¢œä»»åŠ¡ç®¡ç†
    - `ai_provider_bp` - AIæœåŠ¡å•†é…ç½®

11. **å…¶ä»–APIè·¯ç”±**
    - `promotion_api_bp` - æ¨å¹¿API
    - `coupon_api_bp` - ä¼˜æƒ åˆ¸API
    - `user_api_bp` - ç”¨æˆ·API
    - `logistics_api_bp` - ç‰©æµAPI
    - `qrcode_api_bp` - äºŒç»´ç API
    - `staff_permission_bp` - å‘˜å·¥æƒé™

---

## æ–‡ä»¶ç»“æ„æ€»ç»“

### è·¯ç”±æ–‡ä»¶ç›®å½•ç»“æ„

```
app/routes/
â”œâ”€â”€ __init__.py                    # è·¯ç”±æ¨¡å—åˆå§‹åŒ–
â”œâ”€â”€ admin.py                       # ç®¡ç†åå°åŸºç¡€è·¯ç”±
â”œâ”€â”€ admin_orders.py                # è®¢å•ç®¡ç†
â”œâ”€â”€ admin_products_api.py          # äº§å“ç®¡ç†
â”œâ”€â”€ admin_styles_api.py            # é£æ ¼ç®¡ç†API
â”œâ”€â”€ admin_homepage_api.py          # é¦–é¡µé…ç½®API
â”œâ”€â”€ admin_dashboard_api.py         # ä»ªè¡¨ç›˜API
â”œâ”€â”€ admin_coupon_api.py            # ä¼˜æƒ åˆ¸ç®¡ç†
â”œâ”€â”€ admin_promotion_api.py         # æ¨å¹¿ç®¡ç†
â”œâ”€â”€ admin_users_api.py             # ç”¨æˆ·ç®¡ç†
â”œâ”€â”€ admin_notification_api.py      # é€šçŸ¥ç®¡ç†
â”œâ”€â”€ admin_tools_api.py             # å·¥å…·API
â”œâ”€â”€ admin_shop_api.py              # å•†åŸç®¡ç†
â”œâ”€â”€ admin_groupon_api.py           # æ‹¼å›¢ç®¡ç†
â”œâ”€â”€ admin_third_party_groupon_api.py # ç¬¬ä¸‰æ–¹æ‹¼å›¢
â”œâ”€â”€ admin_image_cleanup.py         # å›¾ç‰‡æ¸…ç†
â”œâ”€â”€ admin_profile.py               # ä¸ªäººä¸­å¿ƒ
â”œâ”€â”€ auth.py                        # è®¤è¯è·¯ç”±
â”œâ”€â”€ base.py                        # åŸºç¡€è·¯ç”±
â”œâ”€â”€ merchant.py                    # å•†å®¶ç®¡ç†
â”œâ”€â”€ order.py                       # è®¢å•å¤„ç†
â”œâ”€â”€ payment.py                     # æ”¯ä»˜å¤„ç†
â”œâ”€â”€ media.py                       # åª’ä½“å¤„ç†
â”œâ”€â”€ photo_selection.py             # é€‰ç‰‡ç®¡ç†
â”œâ”€â”€ ai.py                          # AIä»»åŠ¡ç®¡ç†
â”œâ”€â”€ meitu.py                       # ç¾é¢œä»»åŠ¡ç®¡ç†
â”œâ”€â”€ ai_provider.py                 # AIæœåŠ¡å•†é…ç½®
â”œâ”€â”€ user_api.py                    # ç”¨æˆ·API
â”œâ”€â”€ promotion_api.py               # æ¨å¹¿API
â”œâ”€â”€ coupon_api.py                  # ä¼˜æƒ åˆ¸API
â”œâ”€â”€ logistics_api.py               # ç‰©æµAPI
â”œâ”€â”€ qrcode_api.py                  # äºŒç»´ç API
â”œâ”€â”€ staff_permission.py            # å‘˜å·¥æƒé™
â”œâ”€â”€ miniprogram/                   # å°ç¨‹åºæ¥å£ç›®å½•
â”‚   â”œâ”€â”€ __init__.py                # å°ç¨‹åºè·¯ç”±åˆå§‹åŒ–
â”‚   â”œâ”€â”€ catalog.py                 # ç›®å½•æ¥å£ï¼ˆé£æ ¼ã€äº§å“ã€è½®æ’­å›¾ï¼‰
â”‚   â”œâ”€â”€ orders.py                  # è®¢å•æ¥å£
â”‚   â”œâ”€â”€ works.py                   # ä½œå“æ¥å£
â”‚   â”œâ”€â”€ media.py                   # åª’ä½“æ¥å£
â”‚   â”œâ”€â”€ promotion.py               # æ¨å¹¿æ¥å£
â”‚   â”œâ”€â”€ shop.py                    # å•†åŸæ¥å£
â”‚   â”œâ”€â”€ digital_avatar.py          # æ•°å­—äººåƒæ¥å£
â”‚   â”œâ”€â”€ share_reward.py            # åˆ†äº«å¥–åŠ±æ¥å£
â”‚   â”œâ”€â”€ groupon.py                 # æ‹¼å›¢æ¥å£
â”‚   â”œâ”€â”€ third_party_groupon.py     # ç¬¬ä¸‰æ–¹æ‹¼å›¢æ¥å£
â”‚   â””â”€â”€ common.py                  # å°ç¨‹åºå…¬å…±å‡½æ•°
â””â”€â”€ franchisee/                    # åŠ ç›Ÿå•†è·¯ç”±ç›®å½•
    â”œâ”€â”€ __init__.py                # åŠ ç›Ÿå•†è·¯ç”±åˆå§‹åŒ–
    â”œâ”€â”€ admin.py                   # åŠ ç›Ÿå•†ç®¡ç†ï¼ˆç®¡ç†å‘˜ç«¯ï¼‰
    â”œâ”€â”€ frontend.py                # åŠ ç›Ÿå•†å‰ç«¯ï¼ˆåŠ ç›Ÿå•†ç«¯ï¼‰
    â””â”€â”€ api.py                     # åŠ ç›Ÿå•†API
```

### æ¨¡æ¿æ–‡ä»¶ç›®å½•ç»“æ„

```
templates/
â”œâ”€â”€ admin/                         # ç®¡ç†åå°æ¨¡æ¿
â”‚   â”œâ”€â”€ _navbar.html               # å¯¼èˆªæ 
â”‚   â”œâ”€â”€ dashboard.html             # ä»ªè¡¨ç›˜
â”‚   â”œâ”€â”€ orders.html                # è®¢å•åˆ—è¡¨
â”‚   â”œâ”€â”€ order_details.html         # è®¢å•è¯¦æƒ…
â”‚   â”œâ”€â”€ shop_orders.html           # å•†åŸè®¢å•åˆ—è¡¨
â”‚   â”œâ”€â”€ shop_order_detail.html     # å•†åŸè®¢å•è¯¦æƒ…
â”‚   â”œâ”€â”€ photo_selection_list.html  # é€‰ç‰‡åˆ—è¡¨
â”‚   â”œâ”€â”€ photo_selection_detail.html # é€‰ç‰‡è¯¦æƒ…
â”‚   â”œâ”€â”€ franchisee_list.html      # åŠ ç›Ÿå•†åˆ—è¡¨
â”‚   â”œâ”€â”€ franchisee_detail.html     # åŠ ç›Ÿå•†è¯¦æƒ…
â”‚   â”œâ”€â”€ franchisee_edit.html       # åŠ ç›Ÿå•†ç¼–è¾‘
â”‚   â”œâ”€â”€ franchisee_add.html        # æ·»åŠ åŠ ç›Ÿå•†
â”‚   â”œâ”€â”€ franchisee_recharge.html   # åŠ ç›Ÿå•†å……å€¼
â”‚   â”œâ”€â”€ sizes.html                 # äº§å“ç®¡ç†
â”‚   â”œâ”€â”€ shop_products.html         # å•†åŸäº§å“
â”‚   â”œâ”€â”€ styles.html                # é£æ ¼ç®¡ç†
â”‚   â”œâ”€â”€ ai_tasks.html              # AIä»»åŠ¡ç®¡ç†
â”‚   â”œâ”€â”€ meitu_tasks.html           # ç¾é¢œä»»åŠ¡ç®¡ç†
â”‚   â”œâ”€â”€ system_config.html         # ç³»ç»Ÿé…ç½®
â”‚   â”œâ”€â”€ meitu_api_config.html      # ç¾é¢œAPIé…ç½®
â”‚   â”œâ”€â”€ api_provider_config.html   # APIæœåŠ¡å•†é…ç½®
â”‚   â”œâ”€â”€ image_cleanup.html         # å›¾ç‰‡æ¸…ç†
â”‚   â”œâ”€â”€ print_config.html          # æ‰“å°é…ç½®
â”‚   â”œâ”€â”€ printer.html               # æ‰“å°æœºç®¡ç†
â”‚   â”œâ”€â”€ coupons.html               # ä¼˜æƒ åˆ¸ç®¡ç†
â”‚   â”œâ”€â”€ promotion_management.html  # å°ç¨‹åºç”¨æˆ·ç®¡ç†
â”‚   â”œâ”€â”€ homepage.html              # é¦–é¡µé…ç½®
â”‚   â”œâ”€â”€ profile.html               # ä¸ªäººä¸­å¿ƒ
â”‚   â”œâ”€â”€ staff_list.html            # å‘˜å·¥åˆ—è¡¨
â”‚   â”œâ”€â”€ staff_add.html             # æ·»åŠ å‘˜å·¥
â”‚   â”œâ”€â”€ staff_edit.html            # ç¼–è¾‘å‘˜å·¥
â”‚   â”œâ”€â”€ merchants.html             # å•†å®¶åˆ—è¡¨
â”‚   â”œâ”€â”€ merchant_details.html      # å•†å®¶è¯¦æƒ…
â”‚   â””â”€â”€ merchant_edit.html         # å•†å®¶ç¼–è¾‘
â”œâ”€â”€ franchisee/                    # åŠ ç›Ÿå•†æ¨¡æ¿
â”‚   â”œâ”€â”€ login.html                 # åŠ ç›Ÿå•†ç™»å½•
â”‚   â”œâ”€â”€ dashboard.html             # åŠ ç›Ÿå•†ä»ªè¡¨ç›˜
â”‚   â”œâ”€â”€ orders.html                # åŠ ç›Ÿå•†è®¢å•åˆ—è¡¨
â”‚   â”œâ”€â”€ order.html                 # åŠ ç›Ÿå•†è®¢å•è¯¦æƒ…
â”‚   â””â”€â”€ qrcode.html                # åŠ ç›Ÿå•†äºŒç»´ç 
â”œâ”€â”€ merchant/                      # å•†å®¶æ¨¡æ¿
â”‚   â”œâ”€â”€ dashboard.html             # å•†å®¶ä»ªè¡¨ç›˜
â”‚   â””â”€â”€ order.html                 # å•†å®¶è®¢å•
â””â”€â”€ [å…¶ä»–å…¬å…±æ¨¡æ¿]
```

---

## æœåŠ¡å±‚æ–‡ä»¶ç»“æ„

```
app/services/
â”œâ”€â”€ order_service.py               # è®¢å•æœåŠ¡
â”œâ”€â”€ payment_service.py             # æ”¯ä»˜æœåŠ¡
â”œâ”€â”€ ai_provider_service.py         # AIæœåŠ¡å•†æœåŠ¡
â”œâ”€â”€ task_queue_service.py          # ä»»åŠ¡é˜Ÿåˆ—æœåŠ¡
â”œâ”€â”€ ai_task_polling_service.py     # AIä»»åŠ¡è½®è¯¢æœåŠ¡
â””â”€â”€ [å…¶ä»–æœåŠ¡æ–‡ä»¶]
```

---

## å·¥å…·å‡½æ•°æ–‡ä»¶ç»“æ„

```
app/utils/
â”œâ”€â”€ helpers.py                     # è¾…åŠ©å‡½æ•°ï¼ˆç­¾åã€éªŒè¯ç­‰ï¼‰
â”œâ”€â”€ image_utils.py                 # å›¾ç‰‡å¤„ç†å·¥å…·
â”œâ”€â”€ config_loader.py               # é…ç½®åŠ è½½å™¨
â””â”€â”€ [å…¶ä»–å·¥å…·æ–‡ä»¶]
```

---

## æ•°æ®åº“æ¨¡å‹

**æ–‡ä»¶**: `app/models.py`

åŒ…å«æ‰€æœ‰æ•°æ®åº“æ¨¡å‹å®šä¹‰ï¼Œå¦‚ï¼š
- Userï¼ˆç”¨æˆ·ï¼‰
- Orderï¼ˆè®¢å•ï¼‰
- Productï¼ˆäº§å“ï¼‰
- StyleCategoryï¼ˆé£æ ¼åˆ†ç±»ï¼‰
- FranchiseeAccountï¼ˆåŠ ç›Ÿå•†è´¦æˆ·ï¼‰
- ç­‰ç­‰...

---

## æ³¨æ„äº‹é¡¹

1. **è·¯ç”±æ³¨å†Œ**: æ‰€æœ‰è·¯ç”±éƒ½åœ¨ `test_server.py` ä¸­æ³¨å†Œï¼Œç¡®ä¿å¯åŠ¨æ—¶æ‰€æœ‰Blueprintéƒ½è¢«æ­£ç¡®åŠ è½½ã€‚

2. **æ¨¡æ¿è·¯å¾„**: æ‰€æœ‰ç®¡ç†åå°æ¨¡æ¿éƒ½åœ¨ `templates/admin/` ç›®å½•ä¸‹ï¼Œå°ç¨‹åºå’ŒAPPæ¥å£é€šå¸¸è¿”å›JSONï¼Œä¸æ¸²æŸ“æ¨¡æ¿ã€‚

3. **APIå‰ç¼€**: 
   - å°ç¨‹åºæ¥å£: `/api/miniprogram/*`
   - ç®¡ç†åå°API: `/api/admin/*`
   - å…¶ä»–API: `/api/*`

4. **æƒé™æ§åˆ¶**: ç®¡ç†åå°é¡µé¢éƒ½ä½¿ç”¨ `@login_required` è£…é¥°å™¨ï¼Œéƒ¨åˆ†é¡µé¢è¿˜æ£€æŸ¥ç”¨æˆ·è§’è‰²ï¼ˆadmin/operatorï¼‰ã€‚

5. **å»¶è¿Ÿå¯¼å…¥**: å¾ˆå¤šè·¯ç”±æ–‡ä»¶ä½¿ç”¨å»¶è¿Ÿå¯¼å…¥æ¨¡å¼ï¼Œé€šè¿‡ `get_models()` å‡½æ•°è·å–æ•°æ®åº“æ¨¡å‹ï¼Œé¿å…å¾ªç¯å¯¼å…¥é—®é¢˜ã€‚

---

## å¿«é€Ÿç´¢å¼•

### æŒ‰åŠŸèƒ½æ¨¡å—æŸ¥æ‰¾

#### è®¢å•ç›¸å…³
- **ç®¡ç†åå°**: `app/routes/admin_orders.py` â†’ `templates/admin/orders.html`
- **å°ç¨‹åº**: `app/routes/miniprogram/orders.py` â†’ `/api/miniprogram/orders`
- **APP**: `app/routes/order.py` â†’ `/api/orders`
- **åŠ ç›Ÿå•†**: `app/routes/franchisee/frontend.py` â†’ `/franchisee/orders`

#### äº§å“ç›¸å…³
- **ç®¡ç†åå°**: `app/routes/admin_products_api.py` â†’ `templates/admin/sizes.html`
- **å°ç¨‹åº**: `app/routes/miniprogram/catalog.py` â†’ `/api/miniprogram/products`
- **å•†åŸäº§å“**: `app/routes/admin_shop_api.py` â†’ `templates/admin/shop_products.html`
- **å°ç¨‹åºå•†åŸ**: `app/routes/miniprogram/shop.py` â†’ `/api/miniprogram/shop/products`

#### é£æ ¼ç›¸å…³
- **ç®¡ç†åå°**: `app/routes/admin_styles_api.py` â†’ `templates/admin/styles.html`
- **å°ç¨‹åº**: `app/routes/miniprogram/catalog.py` â†’ `/api/miniprogram/styles`

#### æ”¯ä»˜ç›¸å…³
- **æ”¯ä»˜åˆ›å»º**: `app/routes/payment.py` â†’ `/api/payment/create`
- **æ”¯ä»˜å›è°ƒ**: `app/routes/payment.py` â†’ `/api/payment/notify`
- **æœåŠ¡å±‚**: `app/services/payment_service.py`

#### AIç›¸å…³
- **AIä»»åŠ¡ç®¡ç†**: `app/routes/ai.py` â†’ `/admin/ai/tasks`
- **ç¾é¢œä»»åŠ¡ç®¡ç†**: `app/routes/meitu.py` â†’ `/admin/meitu/tasks`
- **AIæœåŠ¡å•†é…ç½®**: `app/routes/ai_provider.py` â†’ `/admin/ai-provider/config`
- **æœåŠ¡å±‚**: `app/services/ai_provider_service.py`

#### ç”¨æˆ·ç›¸å…³
- **å°ç¨‹åºç”¨æˆ·ç®¡ç†**: `app/routes/admin_promotion_api.py` â†’ `templates/admin/promotion_management.html`
- **ç”¨æˆ·API**: `app/routes/user_api.py` â†’ `/api/user/*`
- **å‘˜å·¥ç®¡ç†**: `app/routes/staff_permission.py` â†’ `/admin/staff`

#### ä¼˜æƒ åˆ¸ç›¸å…³
- **ç®¡ç†åå°**: `app/routes/admin_coupon_api.py` â†’ `templates/admin/coupons.html`
- **å°ç¨‹åºAPI**: `app/routes/coupon_api.py` â†’ `/api/coupons/*`

#### åŠ ç›Ÿå•†ç›¸å…³
- **ç®¡ç†ç«¯**: `app/routes/franchisee/admin.py` â†’ `/franchisee/admin/accounts`
- **åŠ ç›Ÿå•†ç«¯**: `app/routes/franchisee/frontend.py` â†’ `/franchisee/dashboard`
- **APIæ¥å£**: `app/routes/franchisee/api.py` â†’ `/franchisee/api/*`

---

## åç»­å·¥ä½œå»ºè®®

1. **æ¥å£æ–‡æ¡£**: å¯ä»¥é’ˆå¯¹æ¯ä¸ªæ¨¡å—ç¼–å†™è¯¦ç»†çš„APIæ¥å£æ–‡æ¡£ï¼ŒåŒ…æ‹¬è¯·æ±‚å‚æ•°ã€å“åº”æ ¼å¼ç­‰ã€‚

2. **åŠŸèƒ½è¯´æ˜**: é’ˆå¯¹ç‰¹æ®ŠåŠŸèƒ½ï¼ˆå¦‚AIä»»åŠ¡å¤„ç†ã€æ”¯ä»˜æµç¨‹ç­‰ï¼‰ç¼–å†™è¯¦ç»†çš„å¯¹æ¥æ–‡æ¡£ã€‚

3. **æ•°æ®åº“è®¾è®¡**: å¯ä»¥è¡¥å……æ•°æ®åº“è¡¨ç»“æ„è¯´æ˜æ–‡æ¡£ã€‚

4. **éƒ¨ç½²è¯´æ˜**: å¯ä»¥è¡¥å……éƒ¨ç½²å’Œé…ç½®è¯´æ˜æ–‡æ¡£ã€‚

5. **APIæµ‹è¯•**: å¯ä»¥åˆ›å»ºPostmanæˆ–Swagger APIæ–‡æ¡£ï¼Œæ–¹ä¾¿æ¥å£æµ‹è¯•ã€‚
