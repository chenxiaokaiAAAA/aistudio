# 代码优化和清理计划

## 任务清单

### 1. 备份文件 ✅
- [x] 创建备份脚本
- [ ] 执行备份（miniprogram.py, franchisee_routes.py）

### 2. 优化 miniprogram.py (1825行)
- [ ] 创建子模块目录 `app/routes/miniprogram/`
- [ ] 拆分订单相关路由 → `orders.py`
- [ ] 拆分媒体文件路由 → `media.py`
- [ ] 拆分风格/产品/轮播图路由 → `catalog.py`
- [ ] 拆分作品路由 → `works.py`
- [ ] 拆分推广码路由 → `promotion.py`
- [ ] 创建 `__init__.py` 统一注册蓝图
- [ ] 更新主文件 `miniprogram.py` 导入子模块

### 3. 优化 franchisee_routes.py (1736行)
- [ ] 迁移到 `app/routes/franchisee.py`
- [ ] 拆分管理员后台管理 → `admin.py`
- [ ] 拆分加盟商管理面板 → `dashboard.py`
- [ ] 拆分加盟商订单管理 → `orders.py`
- [ ] 拆分加盟商API接口 → `api.py`
- [ ] 创建 `__init__.py` 统一注册蓝图
- [ ] 更新 `test_server.py` 中的蓝图注册

### 4. 清理根目录测试脚本
- [ ] 删除 `test_import_models.py`
- [ ] 删除 `cleanup_migrated_functions.py`
- [ ] 删除 `继续整理剩余文件.py`
- [ ] 删除 `test_server - 副本.py`
- [ ] 删除 `test_server.bak`
- [ ] 删除 `backup_files.py`（临时脚本）
- [ ] 删除 `backup_code_optimization.py`（临时脚本）

### 5. 验证
- [ ] 语法检查
- [ ] 测试运行
