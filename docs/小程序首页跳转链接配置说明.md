# å°ç¨‹åºé¦–é¡µè·³è½¬é“¾æ¥é…ç½®è¯´æ˜

## ğŸ“‹ æ¦‚è¿°

å°ç¨‹åºé¦–é¡µçš„å„ä¸ªæ¨¡å—ï¼ˆå½“å­£ä¸»æ¨ã€æ—¶å…‰æ—…ç¨‹ã€IPè”åã€ä½œå“å±•ç¤ºï¼‰ç°åœ¨æ”¯æŒé…ç½®è·³è½¬é“¾æ¥ã€‚å¯ä»¥é€šè¿‡ç®¡ç†åå°é…ç½®æ¯ä¸ªå›¾ç‰‡/é¡¹ç›®çš„è·³è½¬è¡Œä¸ºã€‚

## ğŸ”— è·³è½¬ç±»å‹è¯´æ˜

### æ”¯æŒçš„è·³è½¬ç±»å‹ï¼ˆlink_typeï¼‰

| ç±»å‹ | è¯´æ˜ | link_value æ ¼å¼ | ç¤ºä¾‹ |
|------|------|----------------|------|
| `category` | è·³è½¬åˆ°äº§å“é¦†çš„æŒ‡å®šåˆ†ç±» | åˆ†ç±»IDï¼ˆæ•°å­—ï¼‰ | `1` |
| `product` | è·³è½¬åˆ°äº§å“è¯¦æƒ…é¡µ | äº§å“IDï¼ˆæ•°å­—ï¼‰ | `123` |
| `page` | è·³è½¬åˆ°å°ç¨‹åºé¡µé¢ | é¡µé¢è·¯å¾„ | `/pages/product/product` |
| `url` / `link` | å¤–éƒ¨é“¾æ¥ï¼ˆå¤åˆ¶åˆ°å‰ªè´´æ¿ï¼‰ | å®Œæ•´URL | `https://example.com` |
| `none` | æ— è·³è½¬ï¼ˆé»˜è®¤ï¼‰ | ç©º | - |

## ğŸ“ é…ç½®å­—æ®µè¯´æ˜

### å½“å­£ä¸»æ¨æ¨¡å—ï¼ˆfeatured_sectionï¼‰

æ¯ä¸ª `items` æ•°ç»„ä¸­çš„é¡¹ç›®å¯ä»¥é…ç½®ï¼š

```json
{
  "id": 1,
  "image_url": "/uploads/banner1.jpg",
  "title": "äº§å“æ ‡é¢˜",
  "desc": "äº§å“æè¿°",
  "tag": "æ–°å¹´é™å®š",
  "link_type": "product",      // è·³è½¬ç±»å‹
  "link_value": "123"           // è·³è½¬å€¼ï¼ˆäº§å“IDï¼‰
}
```

### æ—¶å…‰æ—…ç¨‹æ¨¡å—ï¼ˆtime_journeyï¼‰

æ¯ä¸ª `categories` æ•°ç»„ä¸­çš„åˆ†ç±»å¯ä»¥é…ç½®ï¼š

```json
{
  "id": 1,
  "category_name": "å­•å¦ˆ",
  "main_image": "/uploads/journey1.jpg",
  "overlay_text": "è®°å½•ç¾å¥½æ—¶å…‰",
  "link_type": "category",      // è·³è½¬ç±»å‹
  "link_value": "5"              // è·³è½¬å€¼ï¼ˆåˆ†ç±»IDï¼‰
}
```

### IPè”åæ¨¡å—ï¼ˆip_collabï¼‰

æ¯ä¸ª `tabs` æ•°ç»„ä¸­çš„æ ‡ç­¾å¯ä»¥é…ç½®ï¼š

```json
{
  "id": 1,
  "name": "å“ˆåˆ©Â·æ³¢ç‰¹è”åç³»åˆ—",
  "logo": "/uploads/ip1.jpg",
  "images": ["/uploads/ip1-1.jpg", "/uploads/ip1-2.jpg"],
  "link_type": "page",           // è·³è½¬ç±»å‹
  "link_value": "/pages/product/product"  // è·³è½¬å€¼ï¼ˆé¡µé¢è·¯å¾„ï¼‰
}
```

### ä½œå“å±•ç¤ºæ¨¡å—ï¼ˆworksï¼‰

æ¯ä¸ª `tabs` æ•°ç»„ä¸­çš„æ ‡ç­¾å¯ä»¥é…ç½®ï¼š

```json
{
  "id": 1,
  "name": "ç”¨æˆ·æ•…äº‹",
  "main_image": "/uploads/works1.jpg",
  "images": [
    {
      "url": "/uploads/works1-1.jpg",
      "link_type": "product",     // å›¾ç‰‡è·³è½¬ç±»å‹
      "link_value": "123"         // å›¾ç‰‡è·³è½¬å€¼
    }
  ],
  "link_type": "page",            // æ ‡ç­¾æ•´ä½“è·³è½¬ç±»å‹
  "link_value": "/pages/works/works"  // æ ‡ç­¾æ•´ä½“è·³è½¬å€¼
}
```

## ğŸ› ï¸ ç®¡ç†åå°é…ç½®æ–¹æ³•

### æ–¹æ³•1ï¼šé€šè¿‡æ•°æ®åº“ç›´æ¥é…ç½®

åœ¨ `HomepageProductSection` è¡¨çš„ `config` å­—æ®µï¼ˆJSONæ ¼å¼ï¼‰ä¸­æ·»åŠ  `link_type` å’Œ `link_value`ï¼š

```sql
-- ç¤ºä¾‹ï¼šæ›´æ–°å½“å­£ä¸»æ¨æ¨¡å—çš„é…ç½®
UPDATE homepage_product_section 
SET config = json_set(
  config,
  '$.items[0].link_type', 'product',
  '$.items[0].link_value', '123'
)
WHERE section_type = 'featured_section';
```

### æ–¹æ³•2ï¼šé€šè¿‡ç®¡ç†åå°APIé…ç½®

ä½¿ç”¨ `/api/admin/homepage/product-sections` API æ›´æ–°é…ç½®ï¼š

```javascript
// æ›´æ–°å½“å­£ä¸»æ¨æ¨¡å—
PUT /api/admin/homepage/product-sections/{section_id}
{
  "config": {
    "items": [
      {
        "id": 1,
        "image_url": "/uploads/banner1.jpg",
        "title": "äº§å“æ ‡é¢˜",
        "desc": "äº§å“æè¿°",
        "tag": "æ–°å¹´é™å®š",
        "link_type": "product",
        "link_value": "123"
      }
    ],
    "show_subscribe": true
  }
}
```

## ğŸ’¡ ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹1ï¼šå½“å­£ä¸»æ¨è·³è½¬åˆ°äº§å“è¯¦æƒ…

```json
{
  "link_type": "product",
  "link_value": "123"
}
```

ç‚¹å‡»åè·³è½¬åˆ°ï¼š`/pages/product-detail/product-detail?id=123`

### ç¤ºä¾‹2ï¼šæ—¶å…‰æ—…ç¨‹è·³è½¬åˆ°äº§å“åˆ†ç±»

```json
{
  "link_type": "category",
  "link_value": "5"
}
```

ç‚¹å‡»åè·³è½¬åˆ°äº§å“é¦†ï¼Œå¹¶è‡ªåŠ¨é€‰ä¸­åˆ†ç±»IDä¸º5çš„åˆ†ç±»ã€‚

### ç¤ºä¾‹3ï¼šIPè”åè·³è½¬åˆ°é¡µé¢

```json
{
  "link_type": "page",
  "link_value": "/pages/product/product"
}
```

ç‚¹å‡»åè·³è½¬åˆ°äº§å“é¦†é¡µé¢ã€‚

### ç¤ºä¾‹4ï¼šå¤–éƒ¨é“¾æ¥

```json
{
  "link_type": "url",
  "link_value": "https://example.com"
}
```

ç‚¹å‡»åå¤åˆ¶é“¾æ¥åˆ°å‰ªè´´æ¿ï¼Œå¹¶æç¤º"é“¾æ¥å·²å¤åˆ¶"ã€‚

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **å…¼å®¹æ€§**ï¼šå¦‚æœæœªé…ç½® `link_type` å’Œ `link_value`ï¼Œç³»ç»Ÿä¼šå°è¯•ä½¿ç”¨æ—§ç‰ˆæœ¬çš„ `link` å­—æ®µ
2. **ä¼˜å…ˆçº§**ï¼š`link_type` å’Œ `link_value` ä¼˜å…ˆäº `link` å­—æ®µ
3. **é»˜è®¤è¡Œä¸º**ï¼šå¦‚æœæœªé…ç½®ä»»ä½•è·³è½¬é“¾æ¥ï¼Œç‚¹å‡»åä¸ä¼šæ‰§è¡Œä»»ä½•æ“ä½œï¼ˆä½œå“å±•ç¤ºæ¨¡å—ä¼šé¢„è§ˆå›¾ç‰‡ï¼‰

## ğŸ”„ å°ç¨‹åºç«¯å®ç°

å°ç¨‹åºç«¯å·²å®ç°ç»Ÿä¸€çš„è·³è½¬å¤„ç†å‡½æ•° `handleNavigation()`ï¼Œæ”¯æŒï¼š

- âœ… è‡ªåŠ¨è¯†åˆ«è·³è½¬ç±»å‹
- âœ… æ”¯æŒ tabBar é¡µé¢å’Œæ™®é€šé¡µé¢
- âœ… å¤–éƒ¨é“¾æ¥è‡ªåŠ¨å¤åˆ¶åˆ°å‰ªè´´æ¿
- âœ… é”™è¯¯å¤„ç†å’Œç”¨æˆ·æç¤º

## ğŸ“š ç›¸å…³æ–‡ä»¶

- å°ç¨‹åºè·³è½¬é€»è¾‘ï¼š`aistudio-å°ç¨‹åº/pages/index/index.js` (handleNavigationå‡½æ•°)
- åç«¯APIï¼š`app/routes/miniprogram/catalog.py`
- ç®¡ç†åå°APIï¼š`app/routes/admin_homepage_api.py`

---

**æœ€åæ›´æ–°**ï¼š2026-01-31
