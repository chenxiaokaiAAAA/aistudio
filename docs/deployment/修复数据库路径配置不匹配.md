# ä¿®å¤æ•°æ®åº“è·¯å¾„é…ç½®ä¸åŒ¹é…

## ğŸ” é—®é¢˜

- âœ… æ•°æ®åº“æ–‡ä»¶ä½ç½®ï¼š`/root/project_code/instance/pet_painting.db`
- âŒ æ•°æ®åº“é…ç½®ï¼š`sqlite:///pet_painting.db`ï¼ˆä¼šåœ¨é¡¹ç›®æ ¹ç›®å½•æŸ¥æ‰¾ï¼‰
- âŒ æœåŠ¡çŠ¶æ€ï¼š`activating (auto-restart)`ï¼ˆé‡å¯å¾ªç¯ï¼‰

**åŸå› **ï¼šé…ç½®è·¯å¾„ä¸å®é™…æ–‡ä»¶ä½ç½®ä¸åŒ¹é…ã€‚

---

## ğŸ”§ è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆ1ï¼šä¿®æ”¹é…ç½®ä¸º instance è·¯å¾„ï¼ˆæ¨èï¼‰

ä¿®æ”¹ `test_server.py` ä¸­çš„æ•°æ®åº“é…ç½®ï¼š

```bash
# åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œ
cd /root/project_code

# å¤‡ä»½åŸæ–‡ä»¶
cp test_server.py test_server.py.bak

# ä¿®æ”¹é…ç½®ï¼ˆä½¿ç”¨ sedï¼‰
sed -i "s|sqlite:///pet_painting.db|sqlite:///instance/pet_painting.db|g" test_server.py

# éªŒè¯ä¿®æ”¹
grep "SQLALCHEMY_DATABASE_URI" test_server.py
```

### æ–¹æ¡ˆ2ï¼šç§»åŠ¨æ•°æ®åº“æ–‡ä»¶åˆ°æ ¹ç›®å½•

```bash
# ç§»åŠ¨æ•°æ®åº“æ–‡ä»¶åˆ°é¡¹ç›®æ ¹ç›®å½•
mv /root/project_code/instance/pet_painting.db /root/project_code/pet_painting.db

# è®¾ç½®æƒé™
chmod 644 /root/project_code/pet_painting.db
```

---

## âœ… æ¨èä½¿ç”¨æ–¹æ¡ˆ1ï¼ˆä¿®æ”¹é…ç½®ï¼‰

**ä¼˜ç‚¹**ï¼š
- âœ… ä¿æŒæ–‡ä»¶åœ¨ instance ç›®å½•ï¼ˆæ›´è§„èŒƒï¼‰
- âœ… ç¬¦åˆ Flask é¡¹ç›®ç»“æ„

**æ‰§è¡Œå‘½ä»¤**ï¼š

```bash
# 1. å¤‡ä»½
cp /root/project_code/test_server.py /root/project_code/test_server.py.bak

# 2. ä¿®æ”¹é…ç½®
sed -i "s|sqlite:///pet_painting.db|sqlite:///instance/pet_painting.db|g" /root/project_code/test_server.py

# 3. éªŒè¯ä¿®æ”¹
echo "=== ä¿®æ”¹åçš„é…ç½® ==="
grep "SQLALCHEMY_DATABASE_URI" /root/project_code/test_server.py

# 4. é‡å¯æœåŠ¡
systemctl restart aistudio

# 5. æŸ¥çœ‹çŠ¶æ€
sleep 3
systemctl status aistudio --no-pager -l | head -30
```

---

## ğŸ” éªŒè¯ä¿®å¤

```bash
# 1. æ£€æŸ¥æœåŠ¡çŠ¶æ€
systemctl status aistudio --no-pager -l | head -20

# 2. æ£€æŸ¥ç«¯å£
netstat -tlnp | grep 8000

# 3. æŸ¥çœ‹æ—¥å¿—ï¼ˆåº”è¯¥æ²¡æœ‰æ•°æ®åº“é”™è¯¯ï¼‰
journalctl -u aistudio -n 30 --no-pager | grep -i error

# 4. æµ‹è¯•è®¿é—®
curl http://localhost:8000/admin/
```

---

## ğŸ“‹ å®Œæ•´ä¿®å¤å‘½ä»¤ï¼ˆä¸€é”®æ‰§è¡Œï¼‰

```bash
echo "=== 1. å¤‡ä»½åŸæ–‡ä»¶ ==="
cp /root/project_code/test_server.py /root/project_code/test_server.py.bak
echo "âœ… å·²å¤‡ä»½"

echo ""
echo "=== 2. ä¿®æ”¹æ•°æ®åº“é…ç½® ==="
sed -i "s|sqlite:///pet_painting.db|sqlite:///instance/pet_painting.db|g" /root/project_code/test_server.py
echo "âœ… é…ç½®å·²ä¿®æ”¹"

echo ""
echo "=== 3. éªŒè¯ä¿®æ”¹ ==="
grep "SQLALCHEMY_DATABASE_URI" /root/project_code/test_server.py

echo ""
echo "=== 4. é‡å¯æœåŠ¡ ==="
systemctl restart aistudio
sleep 3

echo ""
echo "=== 5. æŸ¥çœ‹çŠ¶æ€ ==="
systemctl status aistudio --no-pager -l | head -20

echo ""
echo "=== 6. æ£€æŸ¥ç«¯å£ ==="
netstat -tlnp | grep 8000 || echo "âš ï¸ ç«¯å£æœªç›‘å¬ï¼Œç­‰å¾…å‡ ç§’åé‡è¯•"

echo ""
echo "=== 7. æŸ¥çœ‹æœ€æ–°æ—¥å¿— ==="
journalctl -u aistudio -n 20 --no-pager | tail -10
```

---

## ğŸ¯ å¦‚æœä¿®å¤æˆåŠŸ

åº”è¯¥çœ‹åˆ°ï¼š
- âœ… æœåŠ¡çŠ¶æ€ï¼š`active (running)`
- âœ… ç«¯å£8000æ­£åœ¨ç›‘å¬
- âœ… æ—¥å¿—ä¸­æ²¡æœ‰æ•°æ®åº“é”™è¯¯
- âœ… `curl` è¿”å› HTTP 200

---

## ğŸš¨ å¦‚æœä»ç„¶å¤±è´¥

æ‰§è¡Œä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹è¯¦ç»†é”™è¯¯ï¼š

```bash
journalctl -u aistudio -n 50 --no-pager | grep -i error
```

æŠŠé”™è¯¯ä¿¡æ¯å‘ç»™æˆ‘ã€‚
