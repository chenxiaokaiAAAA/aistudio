# ä¿®å¤é™æ€æ–‡ä»¶403å’Œå¯†ç é—®é¢˜

## ğŸ” é—®é¢˜åˆ†æ

1. **é™æ€æ–‡ä»¶403é”™è¯¯**ï¼šBootstrap CSS/JS æ–‡ä»¶æ— æ³•è®¿é—®
2. **å¯†ç é”™è¯¯**ï¼šæ— æ³•ç™»å½•

**å¯èƒ½åŸå› **ï¼š
- é™æ€æ–‡ä»¶ç›®å½•æƒé™é—®é¢˜
- é™æ€æ–‡ä»¶è·¯å¾„é…ç½®ä¸æ­£ç¡®
- é™æ€æ–‡ä»¶ç¼ºå¤±
- æ•°æ®åº“ç”¨æˆ·æ•°æ®æœªæ­£ç¡®æ¢å¤

---

## ğŸ”§ ç«‹å³ä¿®å¤

### æ­¥éª¤1ï¼šæ£€æŸ¥é™æ€æ–‡ä»¶

```bash
# æ£€æŸ¥é™æ€æ–‡ä»¶ç›®å½•
ls -la /root/project_code/static/
ls -la /root/project_code/static/css/
ls -la /root/project_code/static/js/

# æ£€æŸ¥æƒé™
find /root/project_code/static -type f -ls | head -20
```

### æ­¥éª¤2ï¼šä¿®å¤é™æ€æ–‡ä»¶æƒé™

```bash
# è®¾ç½®é™æ€æ–‡ä»¶ç›®å½•æƒé™
chmod -R 755 /root/project_code/static
find /root/project_code/static -type f -exec chmod 644 {} \;
find /root/project_code/static -type d -exec chmod 755 {} \;

# æ£€æŸ¥Nginxé…ç½®çš„é™æ€æ–‡ä»¶è·¯å¾„
grep -A 5 "location /static/" /etc/nginx/sites-available/aistudio
```

### æ­¥éª¤3ï¼šæ£€æŸ¥é™æ€æ–‡ä»¶æ˜¯å¦å­˜åœ¨

```bash
# æ£€æŸ¥Bootstrapæ–‡ä»¶
ls -lh /root/project_code/static/css/bootstrap.min.css
ls -lh /root/project_code/static/js/bootstrap.bundle.min.js

# å¦‚æœä¸å­˜åœ¨ï¼Œéœ€è¦ä»å‹ç¼©åŒ…ä¸­æå–æˆ–é‡æ–°ä¸Šä¼ 
```

### æ­¥éª¤4ï¼šé‡ç½®å¯†ç å¹¶æ£€æŸ¥æ•°æ®åº“

```bash
cd /root/project_code
source venv/bin/activate

python << 'PYEOF'
from test_server import app, db, User
from werkzeug.security import generate_password_hash

with app.app_context():
    # æ£€æŸ¥æ‰€æœ‰ç”¨æˆ·
    users = User.query.all()
    print(f"æ•°æ®åº“ä¸­å…±æœ‰ {len(users)} ä¸ªç”¨æˆ·:")
    for user in users:
        print(f"  - ç”¨æˆ·å: {user.username}, è§’è‰²: {user.role}")
    
    # é‡ç½®æˆ–åˆ›å»ºç®¡ç†å‘˜
    admin = User.query.filter_by(username='admin').first()
    if admin:
        admin.password = generate_password_hash('admin123')
        db.session.commit()
        print("\nâœ… ç®¡ç†å‘˜å¯†ç å·²é‡ç½®ä¸º: admin123")
    else:
        admin = User(
            username='admin',
            password=generate_password_hash('admin123'),
            role='admin'
        )
        db.session.add(admin)
        db.session.commit()
        print("\nâœ… ç®¡ç†å‘˜è´¦å·å·²åˆ›å»º: admin/admin123")
    
    # éªŒè¯
    admin = User.query.filter_by(username='admin').first()
    if admin:
        print(f"âœ… éªŒè¯æˆåŠŸ: {admin.username}, è§’è‰²: {admin.role}")
PYEOF
```

---

## ğŸ“‹ å®Œæ•´ä¿®å¤è„šæœ¬

```bash
#!/bin/bash
echo "=========================================="
echo "ä¿®å¤é™æ€æ–‡ä»¶å’Œå¯†ç é—®é¢˜"
echo "=========================================="
echo ""

# 1. æ£€æŸ¥é™æ€æ–‡ä»¶
echo "[1/4] æ£€æŸ¥é™æ€æ–‡ä»¶..."
echo "é™æ€æ–‡ä»¶ç›®å½•:"
ls -la /root/project_code/static/ 2>/dev/null || echo "âš ï¸ staticç›®å½•ä¸å­˜åœ¨"

echo ""
echo "CSSæ–‡ä»¶:"
ls -lh /root/project_code/static/css/bootstrap.min.css 2>/dev/null || echo "âš ï¸ Bootstrap CSSä¸å­˜åœ¨"

echo ""
echo "JSæ–‡ä»¶:"
ls -lh /root/project_code/static/js/bootstrap.bundle.min.js 2>/dev/null || echo "âš ï¸ Bootstrap JSä¸å­˜åœ¨"

# 2. ä¿®å¤æƒé™
echo ""
echo "[2/4] ä¿®å¤é™æ€æ–‡ä»¶æƒé™..."
if [ -d /root/project_code/static ]; then
    chmod -R 755 /root/project_code/static
    find /root/project_code/static -type f -exec chmod 644 {} \;
    find /root/project_code/static -type d -exec chmod 755 {} \;
    echo "âœ… æƒé™å·²è®¾ç½®"
else
    echo "âš ï¸ staticç›®å½•ä¸å­˜åœ¨ï¼Œéœ€è¦åˆ›å»ºæˆ–ä»å‹ç¼©åŒ…æå–"
fi

# 3. æ£€æŸ¥Nginxé…ç½®
echo ""
echo "[3/4] æ£€æŸ¥Nginxé™æ€æ–‡ä»¶é…ç½®..."
grep -A 3 "location /static/" /etc/nginx/sites-available/aistudio

# 4. é‡ç½®å¯†ç 
echo ""
echo "[4/4] é‡ç½®ç®¡ç†å‘˜å¯†ç ..."
cd /root/project_code
source venv/bin/activate

python << 'PYEOF'
from test_server import app, db, User
from werkzeug.security import generate_password_hash

with app.app_context():
    admin = User.query.filter_by(username='admin').first()
    if admin:
        admin.password = generate_password_hash('admin123')
        db.session.commit()
        print("âœ… ç®¡ç†å‘˜å¯†ç å·²é‡ç½®ä¸º: admin123")
    else:
        admin = User(
            username='admin',
            password=generate_password_hash('admin123'),
            role='admin'
        )
        db.session.add(admin)
        db.session.commit()
        print("âœ… ç®¡ç†å‘˜è´¦å·å·²åˆ›å»º: admin/admin123")
PYEOF

echo ""
echo "=========================================="
echo "ä¿®å¤å®Œæˆï¼"
echo "=========================================="
echo ""
echo "å¦‚æœé™æ€æ–‡ä»¶ä¸å­˜åœ¨ï¼Œéœ€è¦ï¼š"
echo "  1. ä»å®Œæ•´å‹ç¼©åŒ…ä¸­æå– static ç›®å½•"
echo "  2. æˆ–é‡æ–°ä¸Šä¼ åŒ…å« static ç›®å½•çš„å‹ç¼©åŒ…"
```

---

## ğŸš¨ å¦‚æœé™æ€æ–‡ä»¶ç¼ºå¤±

### æ–¹æ³•1ï¼šä»å‹ç¼©åŒ…æå–

```bash
# å¦‚æœå‹ç¼©åŒ…è¿˜åœ¨
cd /root/project_code
unzip -o aistudio.zip static/* -d /root/project_code/

# è®¾ç½®æƒé™
chmod -R 755 /root/project_code/static
```

### æ–¹æ³•2ï¼šé‡æ–°ä¸Šä¼ å®Œæ•´å‹ç¼©åŒ…

å¦‚æœé™æ€æ–‡ä»¶ç¡®å®ç¼ºå¤±ï¼Œå»ºè®®ï¼š
1. åœ¨æœ¬åœ°ç¡®ä¿å‹ç¼©åŒ…åŒ…å« `static` ç›®å½•
2. é‡æ–°ä¸Šä¼ å®Œæ•´å‹ç¼©åŒ…
3. è§£å‹è¦†ç›–ç°æœ‰æ–‡ä»¶

---

## ğŸ¯ ç«‹å³æ‰§è¡Œ

æ‰§è¡Œä¸Šé¢çš„**å®Œæ•´ä¿®å¤è„šæœ¬**ï¼Œå®ƒä¼šï¼š
1. æ£€æŸ¥é™æ€æ–‡ä»¶æ˜¯å¦å­˜åœ¨
2. ä¿®å¤æƒé™
3. æ£€æŸ¥Nginxé…ç½®
4. é‡ç½®å¯†ç 

æ‰§è¡Œåå‘Šè¯‰æˆ‘ç»“æœï¼Œç‰¹åˆ«æ˜¯ï¼š
- é™æ€æ–‡ä»¶æ˜¯å¦å­˜åœ¨
- æƒé™æ˜¯å¦å·²ä¿®å¤
- å¯†ç æ˜¯å¦å·²é‡ç½®

å¦‚æœé™æ€æ–‡ä»¶ç¡®å®ç¼ºå¤±ï¼Œæˆ‘ä»¬éœ€è¦é‡æ–°ä¸Šä¼ åŒ…å« `static` ç›®å½•çš„å®Œæ•´å‹ç¼©åŒ…ã€‚
