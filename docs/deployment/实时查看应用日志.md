# å®žæ—¶æŸ¥çœ‹åº”ç”¨æ—¥å¿—ï¼ˆåƒæœ¬åœ° Flask ä¸€æ ·ï¼‰

## ðŸ“‹ æ—¥å¿—ä½ç½®

ç”Ÿäº§çŽ¯å¢ƒä½¿ç”¨ Gunicornï¼Œæ—¥å¿—è¾“å‡ºåˆ°æ–‡ä»¶ï¼Œä¸åƒæœ¬åœ° Flask ç›´æŽ¥è¾“å‡ºåˆ°ç»ˆç«¯ã€‚

---

## ðŸ” æŸ¥çœ‹æ—¥å¿—çš„æ–¹æ³•

### æ–¹æ³•1ï¼šæŸ¥çœ‹ Gunicorn é”™è¯¯æ—¥å¿—ï¼ˆæŽ¨èï¼‰

```bash
# å®žæ—¶æŸ¥çœ‹é”™è¯¯æ—¥å¿—ï¼ˆç±»ä¼¼æœ¬åœ° Flask çš„ç»ˆç«¯è¾“å‡ºï¼‰
tail -f /root/project_code/logs/error.log

# æŸ¥çœ‹æœ€è¿‘ 50 è¡Œ
tail -50 /root/project_code/logs/error.log

# æŸ¥çœ‹è®¿é—®æ—¥å¿—
tail -f /root/project_code/logs/access.log
```

### æ–¹æ³•2ï¼šæŸ¥çœ‹ Systemd æ—¥å¿—

```bash
# å®žæ—¶æŸ¥çœ‹ systemd æ—¥å¿—ï¼ˆæœ€æŽ¥è¿‘æœ¬åœ° Flask çš„è¾“å‡ºï¼‰
journalctl -u aistudio -f

# æŸ¥çœ‹æœ€è¿‘ 100 è¡Œ
journalctl -u aistudio -n 100

# æŸ¥çœ‹ä»Šå¤©çš„æ—¥å¿—
journalctl -u aistudio --since today

# æŸ¥çœ‹æœ€è¿‘ 10 åˆ†é’Ÿ
journalctl -u aistudio --since "10 minutes ago"
```

### æ–¹æ³•3ï¼šæŸ¥çœ‹ Gunicorn æ ‡å‡†è¾“å‡º

å¦‚æžœ Gunicorn é…ç½®äº†è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºï¼Œå¯ä»¥é€šè¿‡ systemd æŸ¥çœ‹ï¼š

```bash
# å®žæ—¶æŸ¥çœ‹
journalctl -u aistudio -f --no-pager

# æŸ¥çœ‹æ‰€æœ‰è¾“å‡ºï¼ˆåŒ…æ‹¬ printï¼‰
journalctl -u aistudio -f | grep -v "GET\|POST"
```

---

## ðŸŽ¯ å¸¸ç”¨å‘½ä»¤

### æŸ¥çœ‹æ‰€æœ‰æ—¥å¿—ï¼ˆé”™è¯¯ + è®¿é—®ï¼‰

```bash
# åœ¨ä¸€ä¸ªç»ˆç«¯æŸ¥çœ‹é”™è¯¯æ—¥å¿—
tail -f /root/project_code/logs/error.log

# åœ¨å¦ä¸€ä¸ªç»ˆç«¯æŸ¥çœ‹è®¿é—®æ—¥å¿—
tail -f /root/project_code/logs/access.log
```

### è¿‡æ»¤ç‰¹å®šå†…å®¹

```bash
# åªæŸ¥çœ‹é”™è¯¯
tail -f /root/project_code/logs/error.log | grep -i error

# åªæŸ¥çœ‹ç‰¹å®šè·¯ç”±
tail -f /root/project_code/logs/access.log | grep "/admin/styles"

# æŸ¥çœ‹ Python print è¾“å‡º
journalctl -u aistudio -f | grep -E "print|âœ…|âŒ|âš ï¸"
```

### æŸ¥çœ‹æœ€è¿‘çš„é”™è¯¯

```bash
# æŸ¥çœ‹æœ€è¿‘ 20 ä¸ªé”™è¯¯
tail -100 /root/project_code/logs/error.log | grep -i error | tail -20
```

---

## ðŸ”§ é…ç½®æ›´è¯¦ç»†çš„æ—¥å¿—

### ä¿®æ”¹ Gunicorn é…ç½®

ç¼–è¾‘ `/root/project_code/gunicorn.conf.py`ï¼š

```python
# æ—¥å¿—é…ç½®
accesslog = "logs/access.log"
errorlog = "logs/error.log"
loglevel = "debug"  # æ”¹ä¸º debug èŽ·å–æ›´è¯¦ç»†ä¿¡æ¯
```

ç„¶åŽé‡å¯æœåŠ¡ï¼š

```bash
systemctl restart aistudio
```

### å¯ç”¨ Flask Debug æ¨¡å¼ï¼ˆä»…å¼€å‘æµ‹è¯•ï¼‰

**âš ï¸ æ³¨æ„ï¼šç”Ÿäº§çŽ¯å¢ƒä¸å»ºè®®å¯ç”¨ debug æ¨¡å¼**

å¦‚æžœéœ€è¦åƒæœ¬åœ°ä¸€æ ·çœ‹åˆ°è¯¦ç»†é”™è¯¯ï¼Œå¯ä»¥ä¸´æ—¶ä¿®æ”¹ `test_server.py`ï¼š

```python
# ä¸´æ—¶å¯ç”¨ï¼ˆä»…ç”¨äºŽè°ƒè¯•ï¼‰
app.config['DEBUG'] = True
```

ä½†**ä¸å»ºè®®åœ¨ç”Ÿäº§çŽ¯å¢ƒä½¿ç”¨**ï¼Œå› ä¸ºä¼šæš´éœ²æ•æ„Ÿä¿¡æ¯ã€‚

---

## ðŸ“ åˆ›å»ºä¾¿æ·è„šæœ¬

åˆ›å»ºä¸€ä¸ªè„šæœ¬æ–¹ä¾¿æŸ¥çœ‹æ—¥å¿—ï¼š

```bash
cat > /root/project_code/view_logs.sh << 'EOF'
#!/bin/bash
# æŸ¥çœ‹åº”ç”¨æ—¥å¿—çš„ä¾¿æ·è„šæœ¬

case "$1" in
    error)
        echo "æŸ¥çœ‹é”™è¯¯æ—¥å¿—ï¼ˆå®žæ—¶ï¼‰..."
        tail -f /root/project_code/logs/error.log
        ;;
    access)
        echo "æŸ¥çœ‹è®¿é—®æ—¥å¿—ï¼ˆå®žæ—¶ï¼‰..."
        tail -f /root/project_code/logs/access.log
        ;;
    systemd)
        echo "æŸ¥çœ‹ systemd æ—¥å¿—ï¼ˆå®žæ—¶ï¼‰..."
        journalctl -u aistudio -f
        ;;
    recent)
        echo "æŸ¥çœ‹æœ€è¿‘ 50 è¡Œé”™è¯¯æ—¥å¿—..."
        tail -50 /root/project_code/logs/error.log
        ;;
    *)
        echo "ç”¨æ³•: $0 {error|access|systemd|recent}"
        echo ""
        echo "  error   - å®žæ—¶æŸ¥çœ‹é”™è¯¯æ—¥å¿—"
        echo "  access  - å®žæ—¶æŸ¥çœ‹è®¿é—®æ—¥å¿—"
        echo "  systemd - å®žæ—¶æŸ¥çœ‹ systemd æ—¥å¿—"
        echo "  recent  - æŸ¥çœ‹æœ€è¿‘ 50 è¡Œé”™è¯¯æ—¥å¿—"
        exit 1
        ;;
esac
EOF

chmod +x /root/project_code/view_logs.sh
```

ä½¿ç”¨ï¼š

```bash
# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
/root/project_code/view_logs.sh error

# æŸ¥çœ‹è®¿é—®æ—¥å¿—
/root/project_code/view_logs.sh access

# æŸ¥çœ‹ systemd æ—¥å¿—
/root/project_code/view_logs.sh systemd

# æŸ¥çœ‹æœ€è¿‘æ—¥å¿—
/root/project_code/view_logs.sh recent
```

---

## ðŸŽ¯ æŽ¨èæ–¹å¼

**æœ€æŽ¥è¿‘æœ¬åœ° Flask è¾“å‡ºçš„æ–¹å¼**ï¼š

```bash
# åœ¨ä¸€ä¸ªç»ˆç«¯çª—å£æ‰§è¡Œï¼ˆä¿æŒè¿è¡Œï¼‰
journalctl -u aistudio -f
```

è¿™ä¼šå®žæ—¶æ˜¾ç¤ºæ‰€æœ‰æ—¥å¿—è¾“å‡ºï¼ŒåŒ…æ‹¬ï¼š
- Python `print()` è¾“å‡º
- Flask æ—¥å¿—
- Gunicorn æ—¥å¿—
- é”™è¯¯ä¿¡æ¯

**æŒ‰ `Ctrl + C` é€€å‡º**

---

## ðŸ“ æ—¥å¿—æ–‡ä»¶è¯´æ˜Ž

- **`logs/error.log`** - Gunicorn é”™è¯¯æ—¥å¿—ï¼ˆåŒ…æ‹¬ Python å¼‚å¸¸ï¼‰
- **`logs/access.log`** - Gunicorn è®¿é—®æ—¥å¿—ï¼ˆHTTP è¯·æ±‚ï¼‰
- **`app.log`** - Flask åº”ç”¨æ—¥å¿—ï¼ˆå¦‚æžœé…ç½®äº†ï¼‰
- **Systemd æ—¥å¿—** - é€šè¿‡ `journalctl` æŸ¥çœ‹ï¼ŒåŒ…å«æ‰€æœ‰æ ‡å‡†è¾“å‡º

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **æ—¥å¿—æ–‡ä»¶ä¼šå¢žé•¿**ï¼Œå®šæœŸæ¸…ç†ï¼š
   ```bash
   # æ¸…ç†æ—§æ—¥å¿—ï¼ˆä¿ç•™æœ€è¿‘ 7 å¤©ï¼‰
   find /root/project_code/logs -name "*.log" -mtime +7 -delete
   ```

2. **ç”Ÿäº§çŽ¯å¢ƒä¸è¦å¯ç”¨ debug æ¨¡å¼**ï¼Œä¼šæš´éœ²æ•æ„Ÿä¿¡æ¯

3. **ä½¿ç”¨ `tail -f` æ—¶**ï¼ŒæŒ‰ `Ctrl + C` é€€å‡ºå®žæ—¶æŸ¥çœ‹
