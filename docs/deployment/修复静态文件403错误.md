# ä¿®å¤é™æ€æ–‡ä»¶ 403 é”™è¯¯

## ğŸ” é—®é¢˜åˆ†æ

æµè§ˆå™¨æ§åˆ¶å°æ˜¾ç¤ºï¼š
```
Failed to load resource: bootstrap.min.css:1 the server responded with a status of 403 (Forbidden)
Failed to load resource: bootstrap.bundle.min.js:1 the server responded with a status of 403 (Forbidden)
```

**åŸå› **ï¼š
1. **æ–‡ä»¶æƒé™é—®é¢˜** - Nginx ç”¨æˆ·ï¼ˆé€šå¸¸æ˜¯ `www-data` æˆ– `nginx`ï¼‰æ— æ³•è¯»å– `static` ç›®å½•
2. **ç›®å½•æƒé™é—®é¢˜** - ç›®å½•æ²¡æœ‰æ‰§è¡Œæƒé™ï¼Œæ— æ³•éå†
3. **Nginx é…ç½®é—®é¢˜** - é™æ€æ–‡ä»¶ location é…ç½®ä¸æ­£ç¡®

---

## ğŸ”§ ç«‹å³ä¿®å¤

### æ–¹æ³•1ï¼šä½¿ç”¨ä¿®å¤è„šæœ¬ï¼ˆæ¨èï¼‰

```bash
cd /root/project_code
chmod +x scripts/deployment/fix_static_files_403.sh
./scripts/deployment/fix_static_files_403.sh
```

### æ–¹æ³•2ï¼šæ‰‹åŠ¨ä¿®å¤

```bash
# 1. æ£€æŸ¥ static ç›®å½•
ls -la /root/project_code/static/

# 2. ä¿®å¤æƒé™
chmod -R 755 /root/project_code/static/
find /root/project_code/static/ -type f -exec chmod 644 {} \;
find /root/project_code/static/ -type d -exec chmod 755 {} \;

# 3. æ£€æŸ¥ Nginx é…ç½®
grep -A 5 "location /static/" /etc/nginx/sites-available/aistudio

# 4. æµ‹è¯•å¹¶é‡å¯ Nginx
nginx -t
systemctl restart nginx
```

---

## ğŸ“‹ å®Œæ•´ä¿®å¤æ­¥éª¤

### æ­¥éª¤1ï¼šæ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨

```bash
cd /root/project_code
ls -la static/css/bootstrap.min.css
ls -la static/js/bootstrap.bundle.min.js
```

å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œéœ€è¦ä¸Šä¼ è¿™äº›æ–‡ä»¶ã€‚

### æ­¥éª¤2ï¼šä¿®å¤æ–‡ä»¶æƒé™

```bash
# ç¡®ä¿ç›®å½•å¯è¯»å¯æ‰§è¡Œ
chmod -R 755 /root/project_code/static/

# ç¡®ä¿æ–‡ä»¶å¯è¯»
find /root/project_code/static/ -type f -exec chmod 644 {} \;

# ç¡®ä¿ç›®å½•å¯æ‰§è¡Œï¼ˆç”¨äºéå†ï¼‰
find /root/project_code/static/ -type d -exec chmod 755 {} \;
```

### æ­¥éª¤3ï¼šæ£€æŸ¥ Nginx ç”¨æˆ·

```bash
# æŸ¥çœ‹ Nginx è¿è¡Œç”¨æˆ·
ps aux | grep nginx | head -1

# é€šå¸¸æ˜¯ www-data æˆ– nginx
# å¦‚æœ Nginx ä¸æ˜¯ä»¥ root è¿è¡Œï¼Œéœ€è¦ç¡®ä¿å®ƒèƒ½è®¿é—®æ–‡ä»¶
```

### æ­¥éª¤4ï¼šæ£€æŸ¥ Nginx é…ç½®

```bash
# æ£€æŸ¥ static location é…ç½®
cat /etc/nginx/sites-available/aistudio | grep -A 5 "location /static/"
```

åº”è¯¥çœ‹åˆ°ç±»ä¼¼ï¼š
```nginx
location /static/ {
    alias /root/project_code/static/;
    expires 30d;
    add_header Cache-Control "public, immutable";
    access_log off;
}
```

### æ­¥éª¤5ï¼šæµ‹è¯•å¹¶é‡å¯ Nginx

```bash
# æµ‹è¯•é…ç½®
nginx -t

# å¦‚æœæµ‹è¯•é€šè¿‡ï¼Œé‡å¯ Nginx
systemctl restart nginx

# æ£€æŸ¥çŠ¶æ€
systemctl status nginx
```

---

## ğŸ” æ’æŸ¥æ­¥éª¤

### 1. æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨

```bash
ls -la /root/project_code/static/css/bootstrap.min.css
ls -la /root/project_code/static/js/bootstrap.bundle.min.js
```

### 2. æ£€æŸ¥æ–‡ä»¶æƒé™

```bash
ls -la /root/project_code/static/
```

åº”è¯¥çœ‹åˆ°ï¼š
- ç›®å½•æƒé™ï¼š`drwxr-xr-x` (755)
- æ–‡ä»¶æƒé™ï¼š`-rw-r--r--` (644)

### 3. æ£€æŸ¥ Nginx é”™è¯¯æ—¥å¿—

```bash
tail -f /var/log/nginx/error.log
```

å¸¸è§é”™è¯¯ï¼š
- `Permission denied` - æƒé™é—®é¢˜
- `No such file or directory` - è·¯å¾„é—®é¢˜

### 4. æµ‹è¯•é™æ€æ–‡ä»¶è®¿é—®

```bash
# åœ¨æœåŠ¡å™¨ä¸Šæµ‹è¯•
curl -I http://localhost/static/css/bootstrap.min.css
```

åº”è¯¥è¿”å› `200 OK`ï¼Œè€Œä¸æ˜¯ `403 Forbidden`ã€‚

---

## ğŸ¯ å¸¸è§é—®é¢˜

### Q1: æ–‡ä»¶å­˜åœ¨ä½†ä»ç„¶æ˜¯ 403

**A**: æ£€æŸ¥ç›®å½•æƒé™ï¼Œç¡®ä¿çˆ¶ç›®å½•ä¹Ÿæœ‰æ‰§è¡Œæƒé™ï¼š
```bash
chmod 755 /root
chmod 755 /root/project_code
chmod -R 755 /root/project_code/static
```

### Q2: Nginx ç”¨æˆ·æ— æ³•è®¿é—® /root ç›®å½•

**A**: å¦‚æœ Nginx ä¸æ˜¯ä»¥ root è¿è¡Œï¼Œå¯èƒ½éœ€è¦ï¼š
1. å°† static ç›®å½•ç§»åŠ¨åˆ° `/var/www/` æˆ– `/usr/share/nginx/html/`
2. æˆ–è€…ä¿®æ”¹ Nginx é…ç½®ä½¿ç”¨ç¬¦å·é“¾æ¥
3. æˆ–è€…ç¡®ä¿ `/root` ç›®å½•å¯¹ Nginx ç”¨æˆ·å¯è¯»

### Q3: ä¿®æ”¹åä»ç„¶æ— æ•ˆ

**A**: 
1. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜ï¼ˆCtrl + Shift + Deleteï¼‰
2. ç¡¬åˆ·æ–°é¡µé¢ï¼ˆCtrl + F5ï¼‰
3. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦è¿˜æœ‰é”™è¯¯
4. æŸ¥çœ‹ Nginx è®¿é—®æ—¥å¿—ï¼š`tail -f /var/log/nginx/access.log`

---

## ğŸ“ éªŒè¯ä¿®å¤

ä¿®å¤åï¼Œåœ¨æµè§ˆå™¨ä¸­ï¼š
1. æŒ‰ `F12` æ‰“å¼€å¼€å‘è€…å·¥å…·
2. æŸ¥çœ‹ Network æ ‡ç­¾
3. åˆ·æ–°é¡µé¢ï¼ˆCtrl + F5ï¼‰
4. æ£€æŸ¥ `bootstrap.min.css` å’Œ `bootstrap.bundle.min.js` çš„çŠ¶æ€
5. åº”è¯¥æ˜¾ç¤º `200 OK` è€Œä¸æ˜¯ `403 Forbidden`

---

## âš ï¸ æ³¨æ„äº‹é¡¹

- **æƒé™è®¾ç½®**ï¼šä¸è¦è®¾ç½®è¿‡äºå®½æ¾çš„æƒé™ï¼ˆå¦‚ 777ï¼‰ï¼Œä¿æŒ 755ï¼ˆç›®å½•ï¼‰å’Œ 644ï¼ˆæ–‡ä»¶ï¼‰å³å¯
- **Nginx ç”¨æˆ·**ï¼šå¦‚æœ Nginx ä¸æ˜¯ä»¥ root è¿è¡Œï¼Œç¡®ä¿å®ƒèƒ½è®¿é—®æ‰€æœ‰å¿…è¦çš„ç›®å½•
- **SELinux**ï¼šå¦‚æœå¯ç”¨äº† SELinuxï¼Œå¯èƒ½éœ€è¦é¢å¤–çš„é…ç½®
