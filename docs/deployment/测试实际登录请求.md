# 测试实际登录请求

## ✅ 当前状态

- ✅ 服务运行正常
- ✅ 端口8000正在监听
- ✅ 登录页面可以访问
- ❌ 登录仍然失败

---

## 🔧 测试实际登录请求

### 步骤1：使用 curl 测试登录

```bash
# 测试登录 POST 请求
curl -v -X POST http://localhost:8000/login \
  -d "username=admin&password=admin123" \
  -c /tmp/cookies.txt \
  -L 2>&1 | head -40
```

### 步骤2：检查响应

查看响应中的：
- HTTP 状态码（应该是 302 重定向）
- Location 头（应该重定向到 `/admin/dashboard`）
- Set-Cookie（应该有 session cookie）

---

## 📋 完整测试脚本

```bash
#!/bin/bash
echo "=========================================="
echo "测试实际登录请求"
echo "=========================================="
echo ""

# 1. 测试登录
echo "[1/2] 测试登录 POST 请求..."
curl -v -X POST http://localhost:8000/login \
  -d "username=admin&password=admin123" \
  -c /tmp/cookies.txt \
  -L 2>&1 | grep -E "HTTP|Location|Set-Cookie|flash|错误" | head -15

echo ""
# 2. 使用 Cookie 访问管理后台
echo "[2/2] 使用 Cookie 访问管理后台..."
curl -b /tmp/cookies.txt http://localhost:8000/admin/dashboard 2>&1 | head -20

echo ""
echo "=========================================="
echo "测试完成！"
echo "=========================================="
```

---

## 🔍 如果 curl 登录成功但浏览器不行

可能是浏览器端的问题：

### 方法1：清除浏览器缓存和 Cookie

1. 按 `Ctrl + Shift + Delete`
2. 选择"Cookie 和其他网站数据"
3. 清除数据
4. 重新访问登录页面

### 方法2：使用无痕模式

1. 按 `Ctrl + Shift + N`（Chrome）或 `Ctrl + Shift + P`（Firefox）
2. 访问：`http://121.43.143.59/login`
3. 尝试登录

### 方法3：检查浏览器控制台

1. 按 `F12` 打开开发者工具
2. 查看 Console 标签的错误
3. 查看 Network 标签的登录请求
4. 查看请求的响应内容

---

## 🎯 立即执行

执行上面的**完整测试脚本**，看看 curl 登录是否成功。

如果 curl 登录成功（返回 302 重定向到 `/admin/dashboard`），说明服务器端正常，问题在浏览器端。

如果 curl 登录也失败，查看响应中的错误信息。

---

## 📝 执行后

执行测试脚本后，告诉我：
1. curl 登录是否成功
2. 如果成功，响应中的 Location 是什么
3. 如果失败，错误信息是什么

这样我可以继续排查。
