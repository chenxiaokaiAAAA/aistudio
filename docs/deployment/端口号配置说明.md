# ç«¯å£å·é…ç½®è¯´æ˜

## ğŸ” é—®é¢˜ç°è±¡

è½®æ’­å›¾URLæ˜¾ç¤ºä¸º `http://121.43.143.59:8000`ï¼ˆæœ‰ç«¯å£8000ï¼‰ï¼Œä½†æœ‰äº›åœ°æ–¹æ˜¾ç¤º `http://121.43.143.59`ï¼ˆæ²¡æœ‰ç«¯å£ï¼‰ã€‚

## ğŸ“‹ åŸå› åˆ†æ

### 1. **æœåŠ¡å™¨æ¶æ„**

ä½ çš„æœåŠ¡å™¨æœ‰ä¸¤ç§è®¿é—®æ–¹å¼ï¼š

#### æ–¹å¼1ï¼šé€šè¿‡Nginxåå‘ä»£ç†ï¼ˆæ¨èï¼‰
- **å¤–éƒ¨è®¿é—®**ï¼š`http://121.43.143.59`ï¼ˆé»˜è®¤80ç«¯å£ï¼‰
- **Nginxè½¬å‘åˆ°**ï¼š`http://127.0.0.1:8000`ï¼ˆFlaskåº”ç”¨ï¼‰
- **é…ç½®åº”è¯¥**ï¼š`base_url = 'http://121.43.143.59'`ï¼ˆ**ä¸éœ€è¦ç«¯å£å·**ï¼‰

#### æ–¹å¼2ï¼šç›´æ¥è®¿é—®Flaskåº”ç”¨
- **ç›´æ¥è®¿é—®**ï¼š`http://121.43.143.59:8000`ï¼ˆFlaskåº”ç”¨ï¼‰
- **é…ç½®åº”è¯¥**ï¼š`base_url = 'http://121.43.143.59:8000'`ï¼ˆ**éœ€è¦ç«¯å£å·**ï¼‰

---

### 2. **å½“å‰é…ç½®æƒ…å†µ**

#### `server_config.py` é…ç½®ï¼š
```python
'production': {
    'base_url': 'http://121.43.143.59',  # âŒ æ²¡æœ‰ç«¯å£å·ï¼ˆå‡è®¾ä½¿ç”¨Nginxï¼‰
    ...
}
```

#### æ•°æ®åº“é…ç½®ï¼ˆç³»ç»Ÿé…ç½®é¡µé¢ï¼‰ï¼š
- å¦‚æœä¿å­˜çš„æ˜¯ï¼š`http://121.43.143.59:8000` â†’ ä¼šæ˜¾ç¤ºç«¯å£å·
- å¦‚æœä¿å­˜çš„æ˜¯ï¼š`http://121.43.143.59` â†’ ä¸ä¼šæ˜¾ç¤ºç«¯å£å·

---

## âœ… è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆ1ï¼šä½¿ç”¨Nginxåå‘ä»£ç†ï¼ˆæ¨èï¼Œç”Ÿäº§ç¯å¢ƒæ ‡å‡†åšæ³•ï¼‰

**ä¼˜ç‚¹**ï¼š
- å¤–éƒ¨è®¿é—®ä¸éœ€è¦ç«¯å£å·ï¼ˆé»˜è®¤80ç«¯å£ï¼‰
- æ›´å®‰å…¨ï¼ˆFlaskåº”ç”¨ä¸ç›´æ¥æš´éœ²ï¼‰
- å¯ä»¥é…ç½®SSL/HTTPS
- å¯ä»¥é…ç½®é™æ€æ–‡ä»¶ç¼“å­˜

**é…ç½®æ­¥éª¤**ï¼š

1. **ç¡®è®¤Nginxé…ç½®**ï¼š
   ```bash
   # æ£€æŸ¥Nginxæ˜¯å¦è¿è¡Œ
   systemctl status nginx
   
   # æ£€æŸ¥Nginxé…ç½®
   cat /etc/nginx/sites-available/aistudio
   ```

2. **ä¿®æ”¹ `server_config.py`**ï¼ˆä¿æŒæ— ç«¯å£ï¼‰ï¼š
   ```python
   'production': {
       'base_url': 'http://121.43.143.59',  # âœ… æ— ç«¯å£å·
       'api_base_url': 'http://121.43.143.59/api',
       'static_url': 'http://121.43.143.59/static',
       'media_url': 'http://121.43.143.59/media',
   }
   ```

3. **ä¿®æ”¹æ•°æ®åº“é…ç½®**ï¼ˆç³»ç»Ÿé…ç½®é¡µé¢ï¼‰ï¼š
   - æœåŠ¡å™¨åŸºç¡€URLï¼š`http://121.43.143.59`ï¼ˆ**ä¸è¦åŠ :8000**ï¼‰
   - APIåŸºç¡€URLï¼š`http://121.43.143.59/api`
   - åª’ä½“æ–‡ä»¶URLï¼š`http://121.43.143.59/media`
   - é™æ€æ–‡ä»¶URLï¼š`http://121.43.143.59/static`

4. **é‡å¯æœåŠ¡**ï¼š
   ```bash
   systemctl restart nginx
   systemctl restart aistudio
   ```

---

### æ–¹æ¡ˆ2ï¼šç›´æ¥è®¿é—®Flaskåº”ç”¨ï¼ˆä¸æ¨èï¼Œä»…ç”¨äºè°ƒè¯•ï¼‰

**é€‚ç”¨åœºæ™¯**ï¼š
- ä¸´æ—¶è°ƒè¯•
- æ²¡æœ‰é…ç½®Nginx
- éœ€è¦ç›´æ¥è®¿é—®Flaskåº”ç”¨

**é…ç½®æ­¥éª¤**ï¼š

1. **ä¿®æ”¹ `server_config.py`**ï¼ˆæ·»åŠ ç«¯å£å·ï¼‰ï¼š
   ```python
   'production': {
       'base_url': 'http://121.43.143.59:8000',  # âœ… æ·»åŠ ç«¯å£å·
       'api_base_url': 'http://121.43.143.59:8000/api',
       'static_url': 'http://121.43.143.59:8000/static',
       'media_url': 'http://121.43.143.59:8000/media',
   }
   ```

2. **ä¿®æ”¹æ•°æ®åº“é…ç½®**ï¼ˆç³»ç»Ÿé…ç½®é¡µé¢ï¼‰ï¼š
   - æœåŠ¡å™¨åŸºç¡€URLï¼š`http://121.43.143.59:8000`ï¼ˆ**æ·»åŠ :8000**ï¼‰
   - APIåŸºç¡€URLï¼š`http://121.43.143.59:8000/api`
   - åª’ä½“æ–‡ä»¶URLï¼š`http://121.43.143.59:8000/media`
   - é™æ€æ–‡ä»¶URLï¼š`http://121.43.143.59:8000/static`

3. **ç¡®ä¿é˜²ç«å¢™å¼€æ”¾8000ç«¯å£**ï¼š
   ```bash
   # æ£€æŸ¥é˜²ç«å¢™è§„åˆ™
   firewall-cmd --list-ports
   
   # å¦‚æœéœ€è¦ï¼Œå¼€æ”¾8000ç«¯å£
   firewall-cmd --permanent --add-port=8000/tcp
   firewall-cmd --reload
   ```

---

## ğŸ” å¦‚ä½•åˆ¤æ–­å½“å‰ä½¿ç”¨å“ªç§æ–¹å¼ï¼Ÿ

### æµ‹è¯•1ï¼šè®¿é—®ä¸»é¡µ
```bash
# æµ‹è¯•80ç«¯å£ï¼ˆNginxï¼‰
curl http://121.43.143.59

# æµ‹è¯•8000ç«¯å£ï¼ˆFlaskï¼‰
curl http://121.43.143.59:8000
```

### æµ‹è¯•2ï¼šæ£€æŸ¥NginxçŠ¶æ€
```bash
systemctl status nginx
```

### æµ‹è¯•3ï¼šæ£€æŸ¥Flaskåº”ç”¨ç«¯å£
```bash
netstat -tlnp | grep 8000
```

---

## ğŸ“ æ¨èé…ç½®ï¼ˆä½¿ç”¨Nginxï¼‰

### 1. `server_config.py`
```python
'production': {
    'base_url': 'http://121.43.143.59',  # æ— ç«¯å£å·
    'api_base_url': 'http://121.43.143.59/api',
    'static_url': 'http://121.43.143.59/static',
    'media_url': 'http://121.43.143.59/media',
    'notify_url': 'http://121.43.143.59/api/payment/notify'
}
```

### 2. æ•°æ®åº“é…ç½®ï¼ˆç³»ç»Ÿé…ç½®é¡µé¢ï¼‰
- æœåŠ¡å™¨åŸºç¡€URLï¼š`http://121.43.143.59`
- APIåŸºç¡€URLï¼š`http://121.43.143.59/api`
- åª’ä½“æ–‡ä»¶URLï¼š`http://121.43.143.59/media`
- é™æ€æ–‡ä»¶URLï¼š`http://121.43.143.59/static`

### 3. å°ç¨‹åº `config.js`
```javascript
production: {
  baseUrl: 'http://121.43.143.59',  // æ— ç«¯å£å·
  apiBaseUrl: 'http://121.43.143.59/api/miniprogram',
  apiUrl: 'http://121.43.143.59/api',
  staticUrl: 'http://121.43.143.59/static',
  mediaUrl: 'http://121.43.143.59/media'
}
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **ç»Ÿä¸€é…ç½®**ï¼šç¡®ä¿ `server_config.py` å’Œæ•°æ®åº“é…ç½®ä¸€è‡´
2. **ä¼˜å…ˆä½¿ç”¨æ•°æ®åº“é…ç½®**ï¼šç³»ç»Ÿé…ç½®é¡µé¢ä¸­çš„é…ç½®ä¼šä¼˜å…ˆäºæ–‡ä»¶é…ç½®
3. **ç«¯å£å·ä¸€è‡´æ€§**ï¼šè¦ä¹ˆéƒ½æœ‰ç«¯å£å·ï¼Œè¦ä¹ˆéƒ½æ²¡æœ‰
4. **ç”Ÿäº§ç¯å¢ƒå»ºè®®**ï¼šä½¿ç”¨Nginxåå‘ä»£ç†ï¼Œä¸æš´éœ²8000ç«¯å£

---

## ğŸ”§ å¿«é€Ÿä¿®å¤

å¦‚æœå½“å‰è½®æ’­å›¾æ˜¾ç¤º `http://121.43.143.59:8000`ï¼Œä½†ä½ æƒ³ä½¿ç”¨æ— ç«¯å£å·çš„æ–¹å¼ï¼š

1. **ä¿®æ”¹æ•°æ®åº“é…ç½®**ï¼ˆç³»ç»Ÿé…ç½®é¡µé¢ï¼‰ï¼š
   - å°†æ‰€æœ‰URLä¸­çš„ `:8000` åˆ é™¤
   - ä¿å­˜é…ç½®

2. **é‡å¯æœåŠ¡**ï¼š
   ```bash
   systemctl restart aistudio
   ```

3. **éªŒè¯**ï¼š
   - åœ¨å°ç¨‹åºä¸­æŸ¥çœ‹è½®æ’­å›¾URL
   - åº”è¯¥æ˜¾ç¤ºä¸º `http://121.43.143.59`ï¼ˆæ— ç«¯å£å·ï¼‰
