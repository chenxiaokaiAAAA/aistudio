# æœåŠ¡å™¨ç«¯æ‰§è¡Œä¿®å¤å‘½ä»¤

## ğŸ“‹ å®Œæ•´ä¿®å¤æµç¨‹

åœ¨æœåŠ¡å™¨ä¸Š**æŒ‰é¡ºåºæ‰§è¡Œ**ä»¥ä¸‹å‘½ä»¤ï¼Œæ¯æ‰§è¡Œä¸€æ­¥åæŠŠè¾“å‡ºå‘ç»™æˆ‘ï¼š

---

## æ­¥éª¤1ï¼šåŸºç¡€ä¿®å¤

```bash
# ä¿®å¤æƒé™
chmod 755 /root
chmod 755 /root/project_code
chmod -R 755 /root/project_code/static
find /root/project_code/static -type f -exec chmod 644 {} \;

# åˆ›å»ºç¬¦å·é“¾æ¥
mkdir -p /var/www
chmod 755 /var/www
ln -sf /root/project_code/static /var/www/static

# æ›´æ–° Nginx é…ç½®
sed -i 's|alias /root/project_code/static/;|alias /var/www/static/;|' /etc/nginx/sites-available/aistudio

# æµ‹è¯•å¹¶é‡å¯
nginx -t && systemctl restart nginx

# æµ‹è¯•è®¿é—®
curl -I http://localhost/static/css/bootstrap.min.css
```

**æ‰§è¡Œåï¼ŒæŠŠè¾“å‡ºå‘ç»™æˆ‘**

---

## æ­¥éª¤2ï¼šå¦‚æœè¿˜æ˜¯ 403ï¼Œæ‰§è¡Œè¯Šæ–­

```bash
echo "=== å®Œæ•´è¯Šæ–­ä¿¡æ¯ ==="
echo ""
echo "1. Nginx è¿è¡Œç”¨æˆ·:"
ps aux | grep '[n]ginx: master' | head -1
echo ""
echo "2. ç›®å½•æƒé™æ£€æŸ¥:"
ls -ld /root
ls -ld /root/project_code
ls -ld /root/project_code/static
ls -ld /var/www
ls -ld /var/www/static
echo ""
echo "3. ç¬¦å·é“¾æ¥æ£€æŸ¥:"
ls -la /var/www/static
readlink -f /var/www/static
echo ""
echo "4. æ–‡ä»¶æƒé™ç¤ºä¾‹:"
ls -la /root/project_code/static/css/bootstrap.min.css
echo ""
echo "5. Nginx é…ç½®:"
grep -A 5 "location /static/" /etc/nginx/sites-available/aistudio
echo ""
echo "6. Nginx é”™è¯¯æ—¥å¿—ï¼ˆæœ€è¿‘ 5 æ¡ï¼‰:"
tail -5 /var/log/nginx/error.log
echo ""
echo "7. æµ‹è¯•è®¿é—®ï¼ˆè¯¦ç»†ï¼‰:"
curl -v http://localhost/static/css/bootstrap.min.css 2>&1 | head -20
```

**æ‰§è¡Œåï¼ŒæŠŠå®Œæ•´è¾“å‡ºå‘ç»™æˆ‘**

---

## æ­¥éª¤3ï¼šå¦‚æœè¿˜æ˜¯ä¸è¡Œï¼Œå°è¯•å…¶ä»–æ–¹æ¡ˆ

### æ–¹æ¡ˆAï¼šæ£€æŸ¥ AppArmorï¼ˆUbuntu å¯èƒ½æœ‰ï¼‰

```bash
# æ£€æŸ¥ AppArmor çŠ¶æ€
aa-status 2>/dev/null || echo "AppArmor æœªå¯ç”¨æˆ–æœªå®‰è£…"

# æ£€æŸ¥ Nginx çš„ AppArmor é…ç½®
cat /etc/apparmor.d/usr.sbin.nginx 2>/dev/null || echo "AppArmor é…ç½®æ–‡ä»¶ä¸å­˜åœ¨"
```

### æ–¹æ¡ˆBï¼šä¸´æ—¶è®© Nginx ä»¥ root è¿è¡Œï¼ˆä»…æµ‹è¯•ï¼‰

```bash
# å¤‡ä»½åŸé…ç½®
cp /etc/nginx/nginx.conf /etc/nginx/nginx.conf.bak

# æ£€æŸ¥å½“å‰ user é…ç½®
grep "^user" /etc/nginx/nginx.conf

# å¦‚æœå­˜åœ¨ user è¡Œï¼Œæ³¨é‡Šæ‰ï¼ˆè®© Nginx ä»¥ root è¿è¡Œï¼‰
sed -i 's/^user /#user /' /etc/nginx/nginx.conf

# æµ‹è¯•å¹¶é‡å¯
nginx -t && systemctl restart nginx

# æµ‹è¯•è®¿é—®
curl -I http://localhost/static/css/bootstrap.min.css
```

**âš ï¸ æ³¨æ„ï¼šè¿™åªæ˜¯ä¸´æ—¶æµ‹è¯•æ–¹æ¡ˆï¼Œç”Ÿäº§ç¯å¢ƒä¸æ¨è**

---

## æ­¥éª¤4ï¼šæœ€ç»ˆéªŒè¯

```bash
echo "=== æœ€ç»ˆéªŒè¯ ==="
echo ""
echo "1. HTTP çŠ¶æ€ç :"
HTTP_CODE=$(curl -s -o /dev/null -w "%{http_code}" http://localhost/static/css/bootstrap.min.css)
echo "HTTP çŠ¶æ€ç : $HTTP_CODE"
echo ""

if [ "$HTTP_CODE" = "200" ]; then
    echo "âœ… ä¿®å¤æˆåŠŸï¼"
    echo ""
    echo "ç°åœ¨è¯·ï¼š"
    echo "  1. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜ï¼ˆCtrl + Shift + Deleteï¼‰"
    echo "  2. ç¡¬åˆ·æ–°é¡µé¢ï¼ˆCtrl + F5ï¼‰"
else
    echo "âŒ ä»ç„¶å¤±è´¥ï¼Œéœ€è¦è¿›ä¸€æ­¥æ’æŸ¥"
    echo ""
    echo "è¯·æ£€æŸ¥ï¼š"
    echo "  - Nginx é”™è¯¯æ—¥å¿—: tail -f /var/log/nginx/error.log"
    echo "  - æ–‡ä»¶æ˜¯å¦å­˜åœ¨: ls -la /root/project_code/static/css/bootstrap.min.css"
    echo "  - SELinux/AppArmor çŠ¶æ€"
fi
```

---

## ğŸ¯ å¿«é€Ÿæ‰§è¡Œï¼ˆä¸€é”®ä¿®å¤ï¼‰

å¦‚æœæƒ³ä¸€æ¬¡æ€§æ‰§è¡Œæ‰€æœ‰ä¿®å¤å‘½ä»¤ï¼š

```bash
cd /root/project_code && \
chmod 755 /root && \
chmod 755 /root/project_code && \
chmod -R 755 /root/project_code/static && \
find /root/project_code/static -type f -exec chmod 644 {} \; && \
mkdir -p /var/www && \
chmod 755 /var/www && \
ln -sf /root/project_code/static /var/www/static && \
sed -i 's|alias /root/project_code/static/;|alias /var/www/static/;|' /etc/nginx/sites-available/aistudio && \
nginx -t && \
systemctl restart nginx && \
sleep 2 && \
echo "æµ‹è¯•ç»“æœ:" && \
curl -I http://localhost/static/css/bootstrap.min.css
```

**æ‰§è¡Œåï¼ŒæŠŠå®Œæ•´è¾“å‡ºå‘ç»™æˆ‘**
