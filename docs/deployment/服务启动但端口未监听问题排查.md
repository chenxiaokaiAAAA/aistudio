# æœåŠ¡å¯åŠ¨ä½†ç«¯å£æœªç›‘å¬é—®é¢˜æ’æŸ¥

## ğŸ” é—®é¢˜ç°è±¡

- âœ… `systemctl status aistudio` æ˜¾ç¤º `active (running)`
- âŒ `netstat -tlnp | grep 8000` æ²¡æœ‰è¾“å‡ºï¼ˆç«¯å£æœªç›‘å¬ï¼‰
- âŒ `curl http://localhost:8000/admin/` è¿”å› `Connection refused`
- âŒ `curl http://121.43.143.59/admin/` è¿”å› 404

**åŸå› **ï¼šè™½ç„¶ systemd æ˜¾ç¤ºæœåŠ¡è¿è¡Œï¼Œä½† Gunicorn å®é™…ä¸Šæ²¡æœ‰æˆåŠŸå¯åŠ¨ã€‚

---

## ğŸ”§ ç«‹å³æ’æŸ¥

### æ­¥éª¤1ï¼šæŸ¥çœ‹è¯¦ç»†æ—¥å¿—

```bash
# æŸ¥çœ‹æœåŠ¡æ—¥å¿—
journalctl -u aistudio -n 100 --no-pager

# æŸ¥çœ‹åº”ç”¨æ—¥å¿—
tail -50 /root/project_code/logs/error.log
tail -50 /root/project_code/logs/startup.log
```

### æ­¥éª¤2ï¼šæ£€æŸ¥è¿›ç¨‹

```bash
# æŸ¥çœ‹Pythonè¿›ç¨‹
ps aux | grep python | grep start_production

# æŸ¥çœ‹Gunicornè¿›ç¨‹
ps aux | grep gunicorn
```

### æ­¥éª¤3ï¼šæ‰‹åŠ¨æµ‹è¯•å¯åŠ¨

```bash
# åœæ­¢æœåŠ¡
systemctl stop aistudio

# æ‰‹åŠ¨å¯åŠ¨ï¼ˆæŸ¥çœ‹é”™è¯¯ä¿¡æ¯ï¼‰
cd /root/project_code
source venv/bin/activate
python start_production.py
```

---

## ğŸš¨ å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ

### é—®é¢˜1ï¼šGunicorn æœªå®‰è£…

**é”™è¯¯ä¿¡æ¯**ï¼š
```
ModuleNotFoundError: No module named 'gunicorn'
```

**è§£å†³**ï¼š
```bash
cd /root/project_code
source venv/bin/activate
pip install gunicorn
systemctl restart aistudio
```

### é—®é¢˜2ï¼štest_server æ¨¡å—å¯¼å…¥å¤±è´¥

**é”™è¯¯ä¿¡æ¯**ï¼š
```
ModuleNotFoundError: No module named 'test_server'
```

**è§£å†³**ï¼š
```bash
# æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
ls -la /root/project_code/test_server.py

# å¦‚æœä¸å­˜åœ¨ï¼Œæ£€æŸ¥é¡¹ç›®ç»“æ„
cd /root/project_code
ls -la *.py
```

### é—®é¢˜3ï¼šæ•°æ®åº“åˆå§‹åŒ–å¤±è´¥

**é”™è¯¯ä¿¡æ¯**ï¼š
```
æ•°æ®åº“åˆå§‹åŒ–å¤±è´¥: ...
```

**è§£å†³**ï¼š
```bash
# åˆ›å»ºinstanceç›®å½•
mkdir -p /root/project_code/instance

# æ£€æŸ¥æƒé™
chmod 755 /root/project_code/instance
```

### é—®é¢˜4ï¼šç«¯å£è¢«å ç”¨

**æ£€æŸ¥**ï¼š
```bash
# æŸ¥çœ‹8000ç«¯å£å ç”¨
lsof -i :8000
# æˆ–
netstat -tlnp | grep 8000
```

**è§£å†³**ï¼š
```bash
# å¦‚æœè¢«å ç”¨ï¼Œæ€æ­»è¿›ç¨‹
kill -9 <PID>

# æˆ–ä¿®æ”¹ç«¯å£ï¼ˆåœ¨gunicorn.conf.pyä¸­ï¼‰
```

### é—®é¢˜5ï¼šå¯åŠ¨è„šæœ¬æ‰§è¡Œå¤±è´¥ä½†systemdè®¤ä¸ºæˆåŠŸ

**åŸå› **ï¼š`Type=simple` æ¨¡å¼ä¸‹ï¼Œsystemd åªè¦è¿›ç¨‹å¯åŠ¨å°±è®¤ä¸ºæˆåŠŸï¼Œå³ä½¿è¿›ç¨‹ç«‹å³é€€å‡ºã€‚

**è§£å†³**ï¼šæŸ¥çœ‹æ—¥å¿—æ‰¾å‡ºçœŸæ­£åŸå› ã€‚

---

## ğŸ” å®Œæ•´è¯Šæ–­å‘½ä»¤

```bash
# 1. åœæ­¢æœåŠ¡
systemctl stop aistudio

# 2. æŸ¥çœ‹æœ€è¿‘æ—¥å¿—
journalctl -u aistudio -n 100 --no-pager

# 3. æ£€æŸ¥åº”ç”¨æ—¥å¿—
ls -la /root/project_code/logs/
tail -50 /root/project_code/logs/error.log 2>/dev/null || echo "æ—¥å¿—æ–‡ä»¶ä¸å­˜åœ¨"
tail -50 /root/project_code/logs/startup.log 2>/dev/null || echo "æ—¥å¿—æ–‡ä»¶ä¸å­˜åœ¨"

# 4. æ£€æŸ¥ä¾èµ–
cd /root/project_code
source venv/bin/activate
pip list | grep -E "gunicorn|flask"

# 5. æ£€æŸ¥æ–‡ä»¶
ls -la /root/project_code/start_production.py
ls -la /root/project_code/test_server.py
ls -la /root/project_code/gunicorn.conf.py

# 6. æ‰‹åŠ¨æµ‹è¯•å¯åŠ¨
python start_production.py
```

---

## ğŸ› ï¸ å¿«é€Ÿä¿®å¤æ–¹æ¡ˆ

### æ–¹æ¡ˆ1ï¼šæ£€æŸ¥å¹¶å®‰è£…ä¾èµ–

```bash
cd /root/project_code
source venv/bin/activate

# å®‰è£…Gunicorn
pip install gunicorn

# æ£€æŸ¥å…¶ä»–ä¾èµ–
pip install -r requirements.txt

# é‡å¯æœåŠ¡
systemctl restart aistudio
systemctl status aistudio
```

### æ–¹æ¡ˆ2ï¼šæ£€æŸ¥å¯åŠ¨è„šæœ¬

```bash
# æ£€æŸ¥å¯åŠ¨è„šæœ¬æƒé™
chmod +x /root/project_code/start_production.py

# æ£€æŸ¥Pythonè·¯å¾„
which python
/root/project_code/venv/bin/python --version

# æ‰‹åŠ¨æµ‹è¯•
cd /root/project_code
source venv/bin/activate
python start_production.py
```

### æ–¹æ¡ˆ3ï¼šä¿®æ”¹æœåŠ¡ç±»å‹ï¼ˆå¦‚æœè¿›ç¨‹ç«‹å³é€€å‡ºï¼‰

å¦‚æœæ‰‹åŠ¨å¯åŠ¨ä¹Ÿç«‹å³é€€å‡ºï¼Œå¯èƒ½éœ€è¦ä¿®æ”¹æœåŠ¡é…ç½®ï¼š

```bash
# ä¿®æ”¹æœåŠ¡ç±»å‹ä¸º forkingï¼ˆå¦‚æœä½¿ç”¨å®ˆæŠ¤è¿›ç¨‹ï¼‰
# æˆ–è€…ä¿æŒ simple ä½†æ·»åŠ æ›´å¤šæ£€æŸ¥
```

---

## ğŸ“‹ è¯Šæ–­æ¸…å•

æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼ŒæŠŠè¾“å‡ºå‘ç»™æˆ‘ï¼š

```bash
echo "=== 1. æœåŠ¡çŠ¶æ€ ==="
systemctl status aistudio --no-pager -l

echo ""
echo "=== 2. æœåŠ¡æ—¥å¿— ==="
journalctl -u aistudio -n 50 --no-pager

echo ""
echo "=== 3. åº”ç”¨æ—¥å¿— ==="
ls -la /root/project_code/logs/ 2>/dev/null || echo "logsç›®å½•ä¸å­˜åœ¨"
tail -30 /root/project_code/logs/error.log 2>/dev/null || echo "error.logä¸å­˜åœ¨"
tail -30 /root/project_code/logs/startup.log 2>/dev/null || echo "startup.logä¸å­˜åœ¨"

echo ""
echo "=== 4. è¿›ç¨‹æ£€æŸ¥ ==="
ps aux | grep -E "python|gunicorn" | grep -v grep

echo ""
echo "=== 5. ç«¯å£æ£€æŸ¥ ==="
netstat -tlnp | grep 8000
lsof -i :8000 2>/dev/null || echo "lsofæœªå®‰è£…"

echo ""
echo "=== 6. æ–‡ä»¶æ£€æŸ¥ ==="
ls -la /root/project_code/start_production.py
ls -la /root/project_code/test_server.py
ls -la /root/project_code/gunicorn.conf.py

echo ""
echo "=== 7. ä¾èµ–æ£€æŸ¥ ==="
cd /root/project_code
source venv/bin/activate
pip list | grep -E "gunicorn|flask"
```

---

## ğŸ¯ ä¸‹ä¸€æ­¥

1. **æ‰§è¡Œè¯Šæ–­å‘½ä»¤**ï¼ŒæŠŠè¾“å‡ºå‘ç»™æˆ‘
2. **æˆ–æ‰‹åŠ¨æµ‹è¯•å¯åŠ¨**ï¼ŒæŠŠé”™è¯¯ä¿¡æ¯å‘ç»™æˆ‘
3. æˆ‘ä¼šæ ¹æ®é”™è¯¯ä¿¡æ¯æä¾›å…·ä½“è§£å†³æ–¹æ¡ˆ
