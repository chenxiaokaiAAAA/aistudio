# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒå¹¶å®‰è£…ä¾èµ–

## ğŸ” é—®é¢˜

- âŒ è™šæ‹Ÿç¯å¢ƒä¸å­˜åœ¨ï¼š`/root/project_code/venv/bin/python` ä¸å­˜åœ¨
- âŒ æœåŠ¡å¯åŠ¨å¤±è´¥ï¼š`Failed to locate executable`

---

## ğŸ”§ ç«‹å³ä¿®å¤

### æ­¥éª¤1ï¼šåˆ›å»ºè™šæ‹Ÿç¯å¢ƒ

```bash
cd /root/project_code
python3 -m venv venv
```

### æ­¥éª¤2ï¼šæ¿€æ´»è™šæ‹Ÿç¯å¢ƒå¹¶å®‰è£…ä¾èµ–

```bash
source venv/bin/activate
pip install --upgrade pip
pip install -r requirements.txt
```

### æ­¥éª¤3ï¼šéªŒè¯å®‰è£…

```bash
# æ£€æŸ¥å…³é”®åŒ…
pip list | grep -E "flask|gunicorn|sqlalchemy"

# æ£€æŸ¥ Python è·¯å¾„
which python
```

### æ­¥éª¤4ï¼šé‡å¯æœåŠ¡

```bash
systemctl restart aistudio
sleep 3
systemctl status aistudio --no-pager -l | head -20
```

---

## ğŸ“‹ å®Œæ•´ä¿®å¤è„šæœ¬

```bash
#!/bin/bash
echo "=========================================="
echo "åˆ›å»ºè™šæ‹Ÿç¯å¢ƒå¹¶å®‰è£…ä¾èµ–"
echo "=========================================="
echo ""

# 1. æ£€æŸ¥ Python
echo "[1/5] æ£€æŸ¥ Python..."
python3 --version
which python3
echo ""

# 2. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
echo "[2/5] åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ..."
cd /root/project_code
if [ -d venv ]; then
    echo "âš ï¸  è™šæ‹Ÿç¯å¢ƒå·²å­˜åœ¨ï¼Œåˆ é™¤åé‡æ–°åˆ›å»º..."
    rm -rf venv
fi

python3 -m venv venv
if [ $? -eq 0 ]; then
    echo "âœ… è™šæ‹Ÿç¯å¢ƒå·²åˆ›å»º"
else
    echo "âŒ è™šæ‹Ÿç¯å¢ƒåˆ›å»ºå¤±è´¥"
    exit 1
fi
echo ""

# 3. æ¿€æ´»å¹¶å‡çº§ pip
echo "[3/5] å‡çº§ pip..."
source venv/bin/activate
pip install --upgrade pip -q
echo "âœ… pip å·²å‡çº§"
echo ""

# 4. å®‰è£…ä¾èµ–
echo "[4/5] å®‰è£…ä¾èµ–ï¼ˆè¿™å¯èƒ½éœ€è¦å‡ åˆ†é’Ÿï¼‰..."
if [ -f requirements.txt ]; then
    pip install -r requirements.txt
    if [ $? -eq 0 ]; then
        echo "âœ… ä¾èµ–å®‰è£…å®Œæˆ"
    else
        echo "âš ï¸  ä¾èµ–å®‰è£…å¯èƒ½æœ‰é—®é¢˜ï¼Œä½†ç»§ç»­..."
    fi
else
    echo "âš ï¸  requirements.txt ä¸å­˜åœ¨ï¼Œå®‰è£…åŸºç¡€ä¾èµ–..."
    pip install flask flask-sqlalchemy flask-login gunicorn
fi
echo ""

# 5. éªŒè¯å®‰è£…
echo "[5/5] éªŒè¯å®‰è£…..."
echo "å…³é”®åŒ…æ£€æŸ¥ï¼š"
pip list | grep -E "flask|gunicorn|sqlalchemy" || echo "âš ï¸  æŸäº›åŒ…å¯èƒ½æœªå®‰è£…"

echo ""
echo "Python è·¯å¾„ï¼š"
which python

echo ""
echo "=========================================="
echo "è™šæ‹Ÿç¯å¢ƒåˆ›å»ºå®Œæˆï¼"
echo "=========================================="
echo ""
echo "ç°åœ¨é‡å¯æœåŠ¡ï¼š"
echo "  systemctl restart aistudio"
echo "  systemctl status aistudio"
```

---

## ğŸš€ ä¸€é”®æ‰§è¡Œï¼ˆåŒ…å«é‡å¯æœåŠ¡ï¼‰

```bash
#!/bin/bash
echo "=========================================="
echo "åˆ›å»ºè™šæ‹Ÿç¯å¢ƒå¹¶é‡å¯æœåŠ¡"
echo "=========================================="
echo ""

# 1. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
echo "[1/4] åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ..."
cd /root/project_code
if [ -d venv ]; then
    rm -rf venv
fi
python3 -m venv venv
echo "âœ… è™šæ‹Ÿç¯å¢ƒå·²åˆ›å»º"
echo ""

# 2. å®‰è£…ä¾èµ–
echo "[2/4] å®‰è£…ä¾èµ–..."
source venv/bin/activate
pip install --upgrade pip -q
pip install -r requirements.txt
echo "âœ… ä¾èµ–å®‰è£…å®Œæˆ"
echo ""

# 3. éªŒè¯
echo "[3/4] éªŒè¯å®‰è£…..."
pip list | grep -E "flask|gunicorn" | head -5
echo ""

# 4. é‡å¯æœåŠ¡
echo "[4/4] é‡å¯æœåŠ¡..."
systemctl restart aistudio
sleep 3

echo ""
echo "=========================================="
echo "å®Œæˆï¼æœåŠ¡çŠ¶æ€ï¼š"
echo "=========================================="
systemctl status aistudio --no-pager -l | head -20

echo ""
echo "ç«¯å£ç›‘å¬ï¼š"
netstat -tlnp | grep 8000 || echo "âš ï¸ ç«¯å£æœªç›‘å¬ï¼Œç­‰å¾…å‡ ç§’åé‡è¯•"
```

---

## âš ï¸ å¦‚æœ requirements.txt ä¸å­˜åœ¨

å¦‚æœå‹ç¼©åŒ…ä¸­æ²¡æœ‰ `requirements.txt`ï¼Œå®‰è£…åŸºç¡€ä¾èµ–ï¼š

```bash
cd /root/project_code
source venv/bin/activate
pip install flask flask-sqlalchemy flask-login gunicorn werkzeug pillow qrcode requests
```

---

## ğŸ¯ ç«‹å³æ‰§è¡Œ

æ‰§è¡Œä¸Šé¢çš„**ä¸€é”®æ‰§è¡Œè„šæœ¬**ï¼Œå®ƒä¼šï¼š
1. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
2. å®‰è£…æ‰€æœ‰ä¾èµ–
3. éªŒè¯å®‰è£…
4. é‡å¯æœåŠ¡

æ‰§è¡Œåå‘Šè¯‰æˆ‘ç»“æœï¼
