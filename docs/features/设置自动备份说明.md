# 设置自动备份 - 快速指南

## 🎯 一键设置（推荐）

### 步骤1：已创建的任务脚本

✅ 已成功创建: `run_database_backup.bat`

### 步骤2：在Windows任务计划程序中设置

1. **打开任务计划程序**
   - 按 `Win + R`
   - 输入 `taskschd.msc`
   - 按回车

2. **创建基本任务**
   - 点击右侧“创建基本任务”
   - 名称输入：`宠物画系统数据库备份`
   - 描述输入：`每天自动备份所有数据库文件`

3. **设置触发器**
   - 选择“每天”
   - 开始时间：`03:00:00`
   - 点击“下一步”

4. **设置操作**
   - 选择“启动程序”
   - 程序或脚本：浏览并选择 `C:\new\pet-painting-system\run_database_backup.bat`
   - 点击“完成”

5. **确认设置**
   - 在任务列表中找到刚创建的任务
   - 确保状态为“就绪”

### 步骤3：验证

等待第二天凌晨3点后，检查：

```bash
# 查看备份文件
ls instance/backups/

# 查看备份日志
python database_backup_scheduler.py --history
```

如果看到新的备份文件（时间戳为当天凌晨3点），说明自动备份已成功启动！

## 📋 任务详情

- **任务名称**: 宠物画系统数据库备份
- **执行时间**: 每天 03:00
- **执行命令**: `run_database_backup.bat`
- **备份位置**: `instance/backups/`
- **保留时间**: 30天
- **自动清理**: 过期备份自动删除

## ✅ 完成后的效果

设置成功后，系统将：
- ✅ 每天凌晨3点自动备份数据库
- ✅ 自动保留最近30天的备份
- ✅ 自动清理过期备份
- ✅ 记录详细备份日志
- ✅ 无需人工干预

## 🔍 故障排查

如果备份没有自动执行：

1. **检查任务状态**
   - 打开任务计划程序
   - 查看任务状态是否为“就绪”

2. **检查任务历史记录**
   - 右键任务 → 属性 → 历史记录
   - 查看是否有错误信息

3. **手动测试**
   ```bash
   # 手动执行一次，确认脚本正常
   python database_backup_scheduler.py --run
   ```

4. **检查Python环境**
   - 确认 `python` 命令可用
   - 确认所有依赖已安装

## 📞 技术支持

如有问题，请查看：
- `数据库备份系统使用指南.md`
- `数据库备份方案总结.md`


