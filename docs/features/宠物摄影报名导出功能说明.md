# 宠物摄影报名导出功能说明

## ✅ 功能概述

在宠物摄影报名管理后台添加了**数据导出功能**，可以将所有报名信息导出为 CSV 格式的表格文件，方便进行数据分析和备份。

## 🎯 功能位置

**管理后台页面**：`https://photogooo/admin/photo-signups`

## 📋 使用步骤

1. **登录管理后台**
   - 访问宠物摄影报名管理页面
   - 页面右上角有"📥 导出数据"按钮

2. **点击导出按钮**
   - 点击"📥 导出数据"按钮
   - 确认要导出所有数据

3. **下载文件**
   - 浏览器会自动下载 CSV 文件
   - 文件名格式：`photo_signups_export_YYYYMMDD_HHMMSS.csv`

4. **打开表格**
   - 使用 Excel、WPS、或任何支持 CSV 格式的软件打开
   - 文件使用 UTF-8 编码，完美支持中文字符

## 📊 导出数据字段

导出的 CSV 文件包含以下字段：

| 字段名 | 说明 | 示例 |
|--------|------|------|
| ID | 记录ID | 1 |
| 姓名 | 用户姓名 | 张三 |
| 手机号 | 联系电话 | 13800138000 |
| 宠物品种 | 宠物品种 | 金毛 |
| 宠物体重 | 宠物体重 | 大型犬 |
| 宠物年龄 | 宠物年龄 | 2岁 |
| 宠物性格 | 宠物性格描述 | 温顺活泼 |
| 预约时间 | 用户选择的预约时间 | 周末 |
| 备注 | 用户备注信息 | 希望拍摄户外照片 |
| 状态 | 报名状态 | 待联系/已联系/已预约/已完成/已取消 |
| 提交时间 | 报名提交时间 | 2025-10-27 10:30:00 |
| 联系时间 | 工作人员联系时间 | 2025-10-27 14:20:00 |
| 预约时间(后台) | 后台设置的预约时间 | 2025-10-30 10:00:00 |
| 到店时间 | 到店拍摄时间 | 2025-10-30 10:30:00 |
| 完成时间 | 拍摄完成时间 | 2025-10-30 12:00:00 |
| 用户ID | 用户ID | USER001 |
| 推广人ID | 推广人ID | PROMO001 |
| 推广码 | 推广码 | PET_PHOTO_2024 |
| 来源 | 报名来源 | miniprogram_carousel |
| 内部备注 | 工作人员备注 | 客户很配合 |
| 图片数量 | 上传的图片数量 | 3 |

## 🔧 技术实现

### 后端 API

**URL**: `/api/photo-signup/export`  
**方法**: `GET`  
**权限**: 无需登录（根据实际需求可添加权限验证）

### 返回格式

- **Content-Type**: `text/csv; charset=utf-8`
- **编码**: UTF-8 with BOM（Excel 完美兼容）
- **文件名**: 自动生成带时间戳的文件名

### 代码位置

**后端路由**: `test_server.py` 第 6908-7005 行
- 导出所有报名记录
- 包含完整的字段信息
- 自动转换状态文本
- 统计图片数量

**前端按钮**: `templates/admin/photo_signups.html` 第 328-331 行
- 页面标题右侧添加导出按钮
- 点击触发下载

**前端脚本**: `templates/admin/photo_signups.html` 第 895-907 行
- `exportSignups()` 函数处理导出逻辑
- 自动创建下载链接并触发下载

## 📝 注意事项

1. **数据量**
   - 导出所有报名记录，不受分页限制
   - 数据量大时可能需要等待几秒钟

2. **文件格式**
   - 使用 UTF-8 编码，Excel 会正确显示中文
   - 如果打开乱码，请检查 Excel 的编码设置

3. **字段说明**
   - "宠物体重"和"宠物年龄"字段现在可以为空（隐藏字段功能）
   - 图片数量统计上传的图片数量
   - 时间字段格式为 `YYYY-MM-DD HH:MM:SS`

4. **数据安全**
   - 导出的数据包含用户个人信息，请妥善保管
   - 建议定期导出作为数据备份

## 🚀 使用示例

### Excel 打开步骤

1. 打开 Excel
2. 选择"数据" → "从文本导入"
3. 选择 CSV 文件
4. 设置分隔符为"逗号"
5. 设置编码为"UTF-8"
6. 完成导入

### 或直接双击打开

CSV 文件可以直接用 Excel 双击打开，会使用默认设置导入。

## 📊 导出示例

```csv
ID,姓名,手机号,宠物品种,宠物体重,宠物年龄,宠物性格,预约时间,备注,状态,提交时间,联系时间,预约时间(后台),到店时间,完成时间,用户ID,推广人ID,推广码,来源,内部备注,图片数量
1,张三,13800138000,金毛,,,温顺活泼,周末,希望拍摄户外照片,待联系,2025-10-27 10:30:00,,,,,USER001,PROMO001,PET_PHOTO_2024,miniprogram_carousel,,3
2,李四,13900139000,柯基,,,活泼好动,工作日,希望在室内拍摄,已联系,2025-10-26 15:20:00,2025-10-27 09:00:00,,,,"",,"",,2
```

## 🎨 界面预览

在管理后台页面顶部，您会看到：

```
📷 宠物摄影报名管理                    [📥 导出数据]
查看和管理用户的宠物摄影报名信息
```

点击"📥 导出数据"按钮即可下载所有数据。

## 🔄 更新说明

- **新增功能**：宠物摄影报名数据导出
- **导出格式**：CSV
- **编码格式**：UTF-8 with BOM（Excel 兼容）
- **包含字段**：21 个字段的完整信息

现在管理员可以轻松导出所有报名数据进行分析和备份了！🎉


